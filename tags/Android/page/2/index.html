<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>标签: Android - 遇寻笔记</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="遇寻笔记"><meta name="msapplication-TileImage" content="/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="遇寻笔记"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="No. I&amp;#39;ll bring me back a souvenir."><meta property="og:type" content="website"><meta property="og:title" content="遇寻笔记"><meta property="og:url" content="https://eucham.me/"><meta property="og:site_name" content="遇寻笔记"><meta property="og:description" content="No. I&amp;#39;ll bring me back a souvenir."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://eucham.me/img/og_image.png"><meta property="article:author" content="遇寻"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://eucham.me/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://eucham.me"},"headline":"遇寻笔记","image":["https://eucham.me/img/og_image.png"],"author":{"@type":"Person","name":"遇寻"},"publisher":{"@type":"Organization","name":"遇寻笔记","logo":{"@type":"ImageObject","url":"https://eucham.me/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png"}},"description":"No. I&#39;ll bring me back a souvenir."}</script><link rel="icon" href="/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?7d79380bb26079f6dd33da78e83cf2ab";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png" alt="遇寻笔记" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/categories/AI">AI</a><a class="navbar-item" href="/categories/Kubernetes">Kubernetes</a><a class="navbar-item" href="/categories/Openstack">Openstack</a><a class="navbar-item" href="/categories/Docker">Container</a><a class="navbar-item" href="/categories/Golang">Golang</a><a class="navbar-item" href="/categories/Rust">Rust</a><a class="navbar-item" href="/about.html">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="To Find Me" href="https://github.com/eucham"><i class="fab fa-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/eucham"><i class="fab fa-linkedin"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">标签</a></li><li class="is-active"><a href="#" aria-current="page">Android</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-03-14T07:07:16.000Z" title="3/14/2018, 3:07:16 PM">2018-03-14</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:26.539Z" title="2/9/2021, 11:03:26 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">10 分钟读完 (大约1434个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/03/14/175b2912dc35.html">系统应用闹钟之TabLayout的使用</a></p><div class="content"><blockquote>
<p>此篇文章记录一些关于安卓原生应用闹钟里面TabLayout的使用，没见过用这个组件的源代码，想从它里面学习学习。就当是见见世面，顺便写个笔记。</p>
</blockquote>
<h2 id="先从印象到布局"><a href="#先从印象到布局" class="headerlink" title="先从印象到布局"></a>先从印象到布局</h2><p>原生闹钟给我的印象非常好，有种说不出的美感。在改工作上的问题时，顺便看它的样式，大致就是一个<code>TabLayout</code>加上四个<code>fragment</code>。</p>
<p>首先是头部的四个图标，是一个嵌在了<code>Toolbar</code>中的<code>TabLayout</code>。<code>Toolbar</code>也是一个<code>ViewGroup</code>，在它的里面放一个其他的控件也是理所当然，只是以前没试过。第一次看到这个写法，感觉非常好。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">android.support.design.widget.AppBarLayout</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">android:background</span>=<span class="string">&quot;@null&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">app:elevation</span>=<span class="string">&quot;0dp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:contentInsetStart</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:ignore</span>=<span class="string">&quot;RtlSymmetry&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.TabLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/tabs&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabGravity</span>=<span class="string">&quot;fill&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabIndicatorColor</span>=<span class="string">&quot;@android:color/transparent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabMaxWidth</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabMode</span>=<span class="string">&quot;fixed&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabPaddingEnd</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:tabPaddingStart</span>=<span class="string">&quot;0dp&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v7.widget.Toolbar</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后在<code>Toolbar</code>下面就是一个<code>ViewPager</code>，存放在一个<code>FrameLayout</code>中。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_behavior</span>=<span class="string">&quot;@string/appbar_scrolling_view_behavior&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.v4.view.ViewPager</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/desk_clock_pager&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:importantForAccessibility</span>=<span class="string">&quot;no&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:saveEnabled</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/drop_shadow&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样基本上大致的框架就出来了。接着看对它的初始化：<br>基本步骤和网上的教程是差不多的，只是其中的<code>UiDataModel</code>感觉非常有意思，感觉它几乎无所不能，用到的任何东西都可以往里面取。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create the tabs that make up the user interface.</span></span><br><span class="line">mTabLayout = (TabLayout) findViewById(R.id.tabs);</span><br><span class="line"><span class="keyword">final</span> <span class="type">int</span> <span class="variable">tabCount</span> <span class="operator">=</span> UiDataModel.getUiDataModel().getTabCount();</span><br><span class="line"><span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">showTabLabel</span> <span class="operator">=</span> getResources().getBoolean(R.bool.showTabLabel);</span><br><span class="line"><span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">showTabHorizontally</span> <span class="operator">=</span> getResources().getBoolean(R.bool.showTabHorizontally);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; tabCount; i++) &#123;</span><br><span class="line">    <span class="keyword">final</span> UiDataModel.<span class="type">Tab</span> <span class="variable">tabModel</span> <span class="operator">=</span> UiDataModel.getUiDataModel().getTab(i);</span><br><span class="line">    <span class="keyword">final</span> <span class="meta">@StringRes</span> <span class="type">int</span> <span class="variable">labelResId</span> <span class="operator">=</span> tabModel.getLabelResId();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> TabLayout.<span class="type">Tab</span> <span class="variable">tab</span> <span class="operator">=</span> mTabLayout.newTab()</span><br><span class="line">            .setTag(tabModel)</span><br><span class="line">            .setIcon(tabModel.getIconResId())</span><br><span class="line">            .setContentDescription(labelResId);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (showTabLabel) &#123;</span><br><span class="line">        tab.setText(labelResId);</span><br><span class="line">        tab.setCustomView(R.layout.tab_item);</span><br><span class="line"></span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;ConstantConditions&quot;)</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">TextView</span> <span class="variable">text</span> <span class="operator">=</span> (TextView) tab.getCustomView()</span><br><span class="line">                .findViewById(android.R.id.text1);</span><br><span class="line">        text.setTextColor(mTabLayout.getTabTextColors());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Bind the icon to the TextView.</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Drawable</span> <span class="variable">icon</span> <span class="operator">=</span> tab.getIcon();</span><br><span class="line">        <span class="keyword">if</span> (showTabHorizontally) &#123;</span><br><span class="line">            <span class="comment">// Remove the icon so it doesn&#x27;t affect the minimum TabLayout height.</span></span><br><span class="line">            tab.setIcon(<span class="literal">null</span>);</span><br><span class="line">            text.setCompoundDrawablesRelativeWithIntrinsicBounds(icon, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            text.setCompoundDrawablesRelativeWithIntrinsicBounds(<span class="literal">null</span>, icon, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>打开<code>UiDataModel</code>，第一个引起我的关注的是一个枚举型，在其中保存了有关<code>Tab</code>的基本信息，如文本、图标资源id以及<strong>该Tab所对应的fragment</strong>等。第一次见到这种写法，有点震惊，同时觉得对于这种静态的应用，用枚举型去保存也符合常理，我觉得这种方法可以以后利用在我写的<code>Android</code>项目中，比如说我的应用中，Tab也是固定的，同时这样写可以让那些信息更加集中，修改起来更加方便，让代码的逻辑性更强。看代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Identifies each of the primary tabs within the application. */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Tab</span> &#123;</span><br><span class="line">    ALARMS(AlarmClockFragment.class, R.drawable.ic_tab_alarm, R.string.menu_alarm),</span><br><span class="line">    CLOCKS(ClockFragment.class, R.drawable.ic_tab_clock, R.string.menu_clock),</span><br><span class="line">    TIMERS(TimerFragment.class, R.drawable.ic_tab_timer, R.string.menu_timer),</span><br><span class="line">    STOPWATCH(StopwatchFragment.class, R.drawable.ic_tab_stopwatch, R.string.menu_stopwatch);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String mFragmentClassName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="meta">@DrawableRes</span> <span class="type">int</span> mIconResId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="meta">@StringRes</span> <span class="type">int</span> mLabelResId;</span><br><span class="line"></span><br><span class="line">    Tab(Class fragmentClass, <span class="meta">@DrawableRes</span> <span class="type">int</span> iconResId, <span class="meta">@StringRes</span> <span class="type">int</span> labelResId) &#123;</span><br><span class="line">        mFragmentClassName = fragmentClass.getName();</span><br><span class="line">        mIconResId = iconResId;</span><br><span class="line">        mLabelResId = labelResId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFragmentClassName</span><span class="params">()</span> &#123; <span class="keyword">return</span> mFragmentClassName; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="meta">@DrawableRes</span> <span class="type">int</span> <span class="title function_">getIconResId</span><span class="params">()</span> &#123; <span class="keyword">return</span> mIconResId; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="meta">@StringRes</span> <span class="type">int</span> <span class="title function_">getLabelResId</span><span class="params">()</span> &#123; <span class="keyword">return</span> mLabelResId; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>感觉自己简直被这源代码所陶醉。后面继续看关于<code>TabLayout</code>的初始化。这其中，对其的适配器的写法，我也是比较感兴趣的。因为自己在写应用的时候，遇到过关于<code>PagerAdapter</code>的问题，所以比较期待它是如何去实现的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Customize the view pager.</span></span><br><span class="line">mFragmentTabPagerAdapter = <span class="keyword">new</span> <span class="title class_">FragmentTabPagerAdapter</span>(<span class="built_in">this</span>);</span><br><span class="line">mFragmentTabPager = (ViewPager) findViewById(R.id.desk_clock_pager);</span><br><span class="line"><span class="comment">// Keep all four tabs to minimize jank.</span></span><br><span class="line">mFragmentTabPager.setOffscreenPageLimit(<span class="number">3</span>);</span><br><span class="line"><span class="comment">// Set Accessibility Delegate to null so view pager doesn&#x27;t intercept movements and</span></span><br><span class="line"><span class="comment">// prevent the fab from being selected.</span></span><br><span class="line">mFragmentTabPager.setAccessibilityDelegate(<span class="literal">null</span>);</span><br><span class="line"><span class="comment">// Mirror changes made to the selected page of the view pager into UiDataModel.</span></span><br><span class="line">mFragmentTabPager.addOnPageChangeListener(<span class="keyword">new</span> <span class="title class_">PageChangeWatcher</span>());</span><br><span class="line">mFragmentTabPager.setAdapter(mFragmentTabPagerAdapter);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Mirror changes made to the selected tab into UiDataModel.</span></span><br><span class="line">mTabLayout.addOnTabSelectedListener(<span class="keyword">new</span> <span class="title class_">TabLayout</span>.OnTabSelectedListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onTabSelected</span><span class="params">(TabLayout.Tab tab)</span> &#123;</span><br><span class="line">        UiDataModel.getUiDataModel().setSelectedTab((UiDataModel.Tab) tab.getTag());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onTabUnselected</span><span class="params">(TabLayout.Tab tab)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onTabReselected</span><span class="params">(TabLayout.Tab tab)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>适配器的源代码不完全贴出来，感觉都对不起这源代码。它继承自<code>ViewPager</code>，自己实现了其中的方法，具体如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * This adapter produces the DeskClockFragments that are the content of the DeskClock tabs. The</span></span><br><span class="line"><span class="comment"> * adapter presents the tabs in LTR and RTL order depending on the text layout direction for the</span></span><br><span class="line"><span class="comment"> * current locale. To prevent issues when switching between LTR and RTL, fragments are registered</span></span><br><span class="line"><span class="comment"> * with the manager using position-independent tags, which is an important departure from</span></span><br><span class="line"><span class="comment"> * FragmentPagerAdapter.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">FragmentTabPagerAdapter</span> <span class="keyword">extends</span> <span class="title class_">PagerAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> DeskClock mDeskClock;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The manager into which fragments are added. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> FragmentManager mFragmentManager;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** A fragment cache that can be accessed before &#123;<span class="doctag">@link</span> #instantiateItem&#125; is called. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;UiDataModel.Tab, DeskClockFragment&gt; mFragmentCache;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The active fragment transaction if one exists. */</span></span><br><span class="line">    <span class="keyword">private</span> FragmentTransaction mCurrentTransaction;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The current fragment displayed to the user. */</span></span><br><span class="line">    <span class="keyword">private</span> Fragment mCurrentPrimaryItem;</span><br><span class="line"></span><br><span class="line">    FragmentTabPagerAdapter(DeskClock deskClock) &#123;</span><br><span class="line">        mDeskClock = deskClock;</span><br><span class="line">        mFragmentCache = <span class="keyword">new</span> <span class="title class_">ArrayMap</span>&lt;&gt;(getCount());</span><br><span class="line">        mFragmentManager = deskClock.getFragmentManager();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> UiDataModel.getUiDataModel().getTabCount();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> position the left-to-right index of the fragment to be returned</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the fragment displayed at the given &#123;<span class="doctag">@code</span> position&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    DeskClockFragment <span class="title function_">getDeskClockFragment</span><span class="params">(<span class="type">int</span> position)</span> &#123;</span><br><span class="line">        <span class="comment">// Fetch the tab the UiDataModel reports for the position.</span></span><br><span class="line">        <span class="keyword">final</span> UiDataModel.<span class="type">Tab</span> <span class="variable">tab</span> <span class="operator">=</span> UiDataModel.getUiDataModel().getTabAt(position);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// First check the local cache for the fragment.</span></span><br><span class="line">        <span class="type">DeskClockFragment</span> <span class="variable">fragment</span> <span class="operator">=</span> mFragmentCache.get(tab);</span><br><span class="line">        <span class="keyword">if</span> (fragment != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> fragment;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Next check the fragment manager; relevant when app is rebuilt after locale changes</span></span><br><span class="line">        <span class="comment">// because this adapter will be new and mFragmentCache will be empty, but the fragment</span></span><br><span class="line">        <span class="comment">// manager will retain the Fragments built on original application launch.</span></span><br><span class="line">        fragment = (DeskClockFragment) mFragmentManager.findFragmentByTag(tab.name());</span><br><span class="line">        <span class="keyword">if</span> (fragment != <span class="literal">null</span>) &#123;</span><br><span class="line">            fragment.setFabContainer(mDeskClock);</span><br><span class="line">            mFragmentCache.put(tab, fragment);</span><br><span class="line">            <span class="keyword">return</span> fragment;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Otherwise, build the fragment from scratch.</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">fragmentClassName</span> <span class="operator">=</span> tab.getFragmentClassName();</span><br><span class="line">        fragment = (DeskClockFragment) Fragment.instantiate(mDeskClock, fragmentClassName);</span><br><span class="line">        fragment.setFabContainer(mDeskClock);</span><br><span class="line">        mFragmentCache.put(tab, fragment);</span><br><span class="line">        <span class="keyword">return</span> fragment;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">startUpdate</span><span class="params">(ViewGroup container)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (container.getId() == View.NO_ID) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;ViewPager with adapter &quot;</span> + <span class="built_in">this</span> + <span class="string">&quot; has no id&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">instantiateItem</span><span class="params">(ViewGroup container, <span class="type">int</span> position)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mCurrentTransaction == <span class="literal">null</span>) &#123;</span><br><span class="line">            mCurrentTransaction = mFragmentManager.beginTransaction();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Use the fragment located in the fragment manager if one exists.</span></span><br><span class="line">        <span class="keyword">final</span> UiDataModel.<span class="type">Tab</span> <span class="variable">tab</span> <span class="operator">=</span> UiDataModel.getUiDataModel().getTabAt(position);</span><br><span class="line">        <span class="type">Fragment</span> <span class="variable">fragment</span> <span class="operator">=</span> mFragmentManager.findFragmentByTag(tab.name());</span><br><span class="line">        <span class="keyword">if</span> (fragment != <span class="literal">null</span>) &#123;</span><br><span class="line">            mCurrentTransaction.attach(fragment);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            fragment = getDeskClockFragment(position);</span><br><span class="line">            mCurrentTransaction.add(container.getId(), fragment, tab.name());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (fragment != mCurrentPrimaryItem) &#123;</span><br><span class="line">            FragmentCompat.setMenuVisibility(fragment, <span class="literal">false</span>);</span><br><span class="line">            FragmentCompat.setUserVisibleHint(fragment, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> fragment;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroyItem</span><span class="params">(ViewGroup container, <span class="type">int</span> position, Object object)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mCurrentTransaction == <span class="literal">null</span>) &#123;</span><br><span class="line">            mCurrentTransaction = mFragmentManager.beginTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">DeskClockFragment</span> <span class="variable">fragment</span> <span class="operator">=</span> (DeskClockFragment) object;</span><br><span class="line">        fragment.setFabContainer(<span class="literal">null</span>);</span><br><span class="line">        mCurrentTransaction.detach(fragment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPrimaryItem</span><span class="params">(ViewGroup container, <span class="type">int</span> position, Object object)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Fragment</span> <span class="variable">fragment</span> <span class="operator">=</span> (Fragment) object;</span><br><span class="line">        <span class="keyword">if</span> (fragment != mCurrentPrimaryItem) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mCurrentPrimaryItem != <span class="literal">null</span>) &#123;</span><br><span class="line">                FragmentCompat.setMenuVisibility(mCurrentPrimaryItem, <span class="literal">false</span>);</span><br><span class="line">                FragmentCompat.setUserVisibleHint(mCurrentPrimaryItem, <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (fragment != <span class="literal">null</span>) &#123;</span><br><span class="line">                FragmentCompat.setMenuVisibility(fragment, <span class="literal">true</span>);</span><br><span class="line">                FragmentCompat.setUserVisibleHint(fragment, <span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            mCurrentPrimaryItem = fragment;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">finishUpdate</span><span class="params">(ViewGroup container)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mCurrentTransaction != <span class="literal">null</span>) &#123;</span><br><span class="line">            mCurrentTransaction.commitAllowingStateLoss();</span><br><span class="line">            mCurrentTransaction = <span class="literal">null</span>;</span><br><span class="line">            mFragmentManager.executePendingTransactions();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isViewFromObject</span><span class="params">(View view, Object object)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ((Fragment) object).getView() == view;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-03-14T05:41:40.000Z" title="3/14/2018, 1:41:40 PM">2018-03-14</time>发表</span><span class="level-item"><time dateTime="2022-04-20T16:08:31.803Z" title="4/21/2022, 12:08:31 AM">2022-04-21</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">7 分钟读完 (大约1072个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/03/14/53dea99bd910.html">修改framework后如何编译、生效！生效！</a></p><div class="content">被framework生效问题困了一天， 一定要记下来。试了网上各种答案，得到的结果都没生效。最终还是从同事那里得到的一份答案，还是同事靠谱啊。一、framework编译方法一般修改framework层的内容分为两种，一种是res，一种是源代码。前者只需要在其目录下，通过mm的方式即可将framewo</div><a class="article-more button is-small is-size-7" href="/2018/03/14/53dea99bd910.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-03-11T05:38:29.000Z" title="3/11/2018, 1:38:29 PM">2018-03-11</time>发表</span><span class="level-item"><time dateTime="2022-04-20T16:08:40.774Z" title="4/21/2022, 12:08:40 AM">2022-04-21</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">6 分钟读完 (大约963个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/03/11/66fd5b4ee73f.html">插入耳机时安全音量提示</a></p><div class="content">插入耳机的状态下，当音量达到某个值得时候，会弹出一个“继续提高音量将损害听力”的提示框。这只是一普通的对话框而已，但是这与需求不太一样，需要做一些微微的调整。源码的目录：Android 8.0中，位于：frameworks/base/packages/SystemUI/src/com/android</div><a class="article-more button is-small is-size-7" href="/2018/03/11/66fd5b4ee73f.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-01-21T00:31:51.000Z" title="1/21/2018, 8:31:51 AM">2018-01-21</time>发表</span><span class="level-item"><time dateTime="2022-04-20T16:08:49.473Z" title="4/21/2022, 12:08:49 AM">2022-04-21</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">9 分钟读完 (大约1358个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/01/21/b00570593d4c.html">Android开发工具系之ADB</a></p><div class="content">ADB的相关概念&amp;工作原理通过WLAN使用ADB感觉这个挺有意思，但是又在情理之中。1、电脑与设备连入同一个局域网，并能连通。2、将设备接上电脑，设置端口。λ adb tcpip 5555restarting in TCP mode port: 55553、断开设备4、找出设备的IP地址5、</div><a class="article-more button is-small is-size-7" href="/2018/01/21/b00570593d4c.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-12-25T22:51:12.000Z" title="12/26/2017, 6:51:12 AM">2017-12-26</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:23.303Z" title="2/9/2021, 11:03:23 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">4 分钟读完 (大约562个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/12/26/f63384973df3.html">Android中的apk打包</a></p><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>使用友盟对应用进行信息收集时，其中包含有一个渠道名。渠道姑且可以认为是一个商店吧，如果应用要在很多个商店上面上架的话，一直改太麻烦了。有一个叫做多渠道打包的东西自然而然地走了过来。</p>
<h2 id="多渠道打包实现"><a href="#多渠道打包实现" class="headerlink" title="多渠道打包实现"></a>多渠道打包实现</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;UMENG_APPKEY&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:value</span>=<span class="string">&quot;xxxxxxxxxxxxxxxxxxxxxx&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;UMENG_CHANNEL&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:value</span>=<span class="string">&quot;Google Play Store&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>如上所示，如果需要换一个渠道的话，重新改的话就特别麻烦了。先将其中的value替换成占位符<code>$&#123;UMENG_CHANNEL_VALUE&#125;</code>。接下来到模块下的<code>build.gradle</code>中进行相应的修改。修改大致如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;UMENG_CHANNEL&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:value</span>=<span class="string">&quot;$&#123;UMENG_CHANNEL_NAME&#125;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>接下来配置<code>build.gradle</code></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">defaultConfig &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// 默认是umeng的渠道</span></span><br><span class="line">    manifestPlaceholders = [UMENG_CHANNEL_VALUE: <span class="string">&quot;umeng&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 友盟多渠道打包</span></span><br><span class="line">flavorDimensions <span class="string">&quot;wtf&quot;</span></span><br><span class="line">productFlavors&#123;</span><br><span class="line">    google &#123;</span><br><span class="line">        dimension <span class="string">&quot;wtf&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    coolapk &#123;</span><br><span class="line">        dimension <span class="string">&quot;wtf&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">productFlavors.all &#123; flavor -&gt;</span><br><span class="line">    flavor.manifestPlaceholders = [UMENG_CHANNEL_VALUE: name]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="自动设置应用签名"><a href="#自动设置应用签名" class="headerlink" title="自动设置应用签名"></a>自动设置应用签名</h2><p>在buildType{}前添加下段，并在buildType的release中添加<code>signingConfig signingConfigs.release</code></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">signingConfigs &#123;</span><br><span class="line">    debug &#123;</span><br><span class="line">        <span class="comment">// No debug config</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    release &#123;</span><br><span class="line">        storeFile <span class="keyword">file</span>(<span class="string">&quot;../yourapp.keystore&quot;</span>)</span><br><span class="line">        storePassword <span class="string">&quot;your password&quot;</span></span><br><span class="line">        keyAlias <span class="string">&quot;your alias&quot;</span></span><br><span class="line">        keyPassword <span class="string">&quot;your password&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打release版本的包时就会使用其中所配置的签名了。</p>
<h2 id="修改AS生成的apk默认名"><a href="#修改AS生成的apk默认名" class="headerlink" title="修改AS生成的apk默认名"></a>修改AS生成的apk默认名</h2><p>不同gradle版本间存在一些差异，如果报错了，google修改一下。</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">applicationVariants.all &#123; variant -&gt;</span><br><span class="line">    variant.outputs.all &#123; output -&gt;</span><br><span class="line"><span class="comment">//                    outputFileName = new File(</span></span><br><span class="line"><span class="comment">//                            &quot;JPreader-&quot; + $&#123;variant.productFlavors[0].name&#125; +</span></span><br><span class="line"><span class="comment">//                                    buildType.name + &quot;-v&quot; +</span></span><br><span class="line"><span class="comment">//                                    defaultConfig.versionName + &quot;-&quot; +</span></span><br><span class="line"><span class="comment">//                                    defaultConfig.versionCode + &quot;.apk&quot; )</span></span><br><span class="line">        <span class="keyword">if</span> (outputFile != <span class="keyword">null</span> &amp;&amp; outputFile.name.endsWith(<span class="string">&#x27;.apk&#x27;</span>)) &#123;</span><br><span class="line">            <span class="comment">// 输出apk名称为ruijie_v1.0_wandoujia.apk</span></span><br><span class="line">            <span class="keyword">def</span> fileName = <span class="string">&quot;JPreader_v$&#123;defaultConfig.versionName&#125;_$&#123;variant.productFlavors[0].name&#125;.apk&quot;</span></span><br><span class="line">            outputFileName = <span class="keyword">new</span> <span class="keyword">File</span>(fileName)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p><code>build.gradle</code>真的是神奇，有一些用法还是可以去学学。当前的<code>build.gradle</code>文件的整体如下所示：</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion <span class="number">26</span></span><br><span class="line">    buildToolsVersion <span class="string">&#x27;26.0.2&#x27;</span></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">&quot;cn.xuchuanjun.nhknews&quot;</span></span><br><span class="line">        minSdkVersion <span class="number">19</span></span><br><span class="line">        targetSdkVersion <span class="number">26</span></span><br><span class="line">        versionCode <span class="number">2</span></span><br><span class="line">        versionName <span class="string">&quot;1.1&quot;</span></span><br><span class="line">        testInstrumentationRunner <span class="string">&quot;android.support.test.runner.AndroidJUnitRunner&quot;</span></span><br><span class="line"><span class="comment">//        jackOptions &#123;</span></span><br><span class="line"><span class="comment">//            enabled true</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="comment">//multiDexEnable true //突破应用方法数65535的一个限制</span></span><br><span class="line">        manifestPlaceholders=[UMENG_CHANNEL_NAME:<span class="string">&quot;Google Play Store&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        debug &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        myReleaseConfig &#123;</span><br><span class="line">            storeFile <span class="keyword">file</span>(<span class="string">&quot;xxxxxxxxxxxxxxxxx.jks&quot;</span>)</span><br><span class="line">            storePassword <span class="string">&quot;xxxxxxxx&quot;</span></span><br><span class="line">            keyAlias <span class="string">&quot;xxxxxx&quot;</span></span><br><span class="line">            keyPassword <span class="string">&quot;xxxxxxxx&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.pro&#x27;</span></span><br><span class="line">            signingConfig signingConfigs.myReleaseConfig</span><br><span class="line"></span><br><span class="line">            applicationVariants.all &#123; variant -&gt;</span><br><span class="line">                variant.outputs.all &#123; output -&gt;</span><br><span class="line"><span class="comment">//                    outputFileName = new File(</span></span><br><span class="line"><span class="comment">//                            &quot;JPreader-&quot; + $&#123;variant.productFlavors[0].name&#125; +</span></span><br><span class="line"><span class="comment">//                                    buildType.name + &quot;-v&quot; +</span></span><br><span class="line"><span class="comment">//                                    defaultConfig.versionName + &quot;-&quot; +</span></span><br><span class="line"><span class="comment">//                                    defaultConfig.versionCode + &quot;.apk&quot; )</span></span><br><span class="line">                    <span class="keyword">if</span> (outputFile != <span class="keyword">null</span> &amp;&amp; outputFile.name.endsWith(<span class="string">&#x27;.apk&#x27;</span>)) &#123;</span><br><span class="line">                        <span class="comment">// 输出apk名称为ruijie_v1.0_wandoujia.apk</span></span><br><span class="line">                        <span class="keyword">def</span> fileName = <span class="string">&quot;JPreader_v$&#123;defaultConfig.versionName&#125;_$&#123;variant.productFlavors[0].name&#125;.apk&quot;</span></span><br><span class="line">                        outputFileName = <span class="keyword">new</span> <span class="keyword">File</span>(fileName)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    flavorDimensions <span class="string">&quot;wtf&quot;</span></span><br><span class="line">    productFlavors&#123;</span><br><span class="line">        google &#123;</span><br><span class="line">            dimension <span class="string">&quot;wtf&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        coolapk &#123;</span><br><span class="line">            dimension <span class="string">&quot;wtf&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    productFlavors.all&#123;</span><br><span class="line">        flavor -&gt; flavor.manifestPlaceholders = [UMENG_CHANNEL_NAME:name]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        <span class="keyword">targetCompatibility</span> <span class="number">1.8</span></span><br><span class="line">        <span class="keyword">sourceCompatibility</span> <span class="number">1.8</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        <span class="keyword">flatDir</span> &#123;</span><br><span class="line">            dirs <span class="string">&#x27;libs&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-12-20T01:08:11.000Z" title="12/20/2017, 9:08:11 AM">2017-12-20</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:17.624Z" title="2/9/2021, 11:03:17 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">3 分钟读完 (大约480个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/12/20/fb56c6aa1402.html">Android中的签名</a></p><div class="content"><p>签名，顾名思义与生活中的签名类似，为某个东西签了名，那么这个东西就与所签的名字产生了某种关系，如归属等。</p>
<h2 id="为什么要为Android应用签名？"><a href="#为什么要为Android应用签名？" class="headerlink" title="为什么要为Android应用签名？"></a>为什么要为Android应用签名？</h2><p>这是因为Android系统的要求就是这样，Android系统要求每一个Android应用程序必须要经过数字签名才能够安装到系统中，也就是说如果一个Android应用程序没有经过数字签名，就无法安装到系统中。</p>
<p>为什么在AS中直接RUN可以安装到系统上？<br>因为这种方式会使用Android Studio默认生成的debug签名，去给应用进行签名。</p>
<h2 id="签名不同会怎样"><a href="#签名不同会怎样" class="headerlink" title="签名不同会怎样"></a>签名不同会怎样</h2><p>如果同一应用使用不同的签名，那么将不能覆盖安装，必须先卸载之前的，然后再安装。</p>
<p>1）两个程序的入口Activity是否相同。两个程序如果包名不一样，即使其它所有代码完全一样，也不会被视为同一个程序的不同版本； 2）两个程序所采用的签名是否相同。如果两个程序所采用的签名不同，即使包名相同，也不会被视为同一个程序的不同版本，不能覆盖安装。</p>
<p>所以这也是为什么，同样一份代码，由不同的机器RUN，然后安装到同一台设备上时，需要先卸载之前的应用，而后再安装此次的。</p>
<p>原因就是每台机器默认生成的debug签名都不一样！</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>应用商城不接受用debug签名签的应用，必须使用自己的签名。</p>
<p>使用自己的签名可以避免应用不具备升级功能。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-12-18T07:37:48.000Z" title="12/18/2017, 3:37:48 PM">2017-12-18</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:04:03.037Z" title="2/9/2021, 11:04:03 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">8 分钟读完 (大约1226个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/12/18/3fa176e87f9d.html">Android中的looper与handler</a></p><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>为什么会有这么一篇网上有很多种解说版本的博客？因为我看懂了很多次，都没有把自己的想法记下来，然后就忘了。那样不仅浪费时间、而且还有点伤积极性。</p>
<h2 id="从一个异常出发开始"><a href="#从一个异常出发开始" class="headerlink" title="从一个异常出发开始"></a>从一个异常出发开始</h2><p>在《第一行代码》中看到了关于异步处理消息的用法时，有没有想过可以在子线程中去new一个Handler？现在就开始着手，从一个子线程中去new一个Handler，看看会有什么发生。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Handler</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>

<p>结果就出现了RuntimeException异常，仔细看它的信息说明。</p>
<p><code>java.lang.RuntimeException: Can&#39;t create handler inside thread that has not called Looper.prepare()</code></p>
<p>那么可知，在每个线程<code>new Handler()</code>时，都必须先调用<code>Looper.prepare()</code>或者调用一个能够达到相同效果的函数。那么在主线程中可以<code>new Handler()</code>的原因，想必就是已经调用过了。以下代码位于AcitivityThread.java中，是一段初始化主线程的内容。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Looper.prepareMainLooper();</span><br><span class="line"></span><br><span class="line"><span class="type">ActivityThread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ActivityThread</span>();</span><br><span class="line">thread.attach(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (sMainThreadHandler == <span class="literal">null</span>) &#123;</span><br><span class="line">	sMainThreadHandler = thread.getHandler();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">	Looper.myLooper().setMessageLogging(</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">LogPrinter</span>(Log.DEBUG, <span class="string">&quot;ActivityThread&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// End of event ActivityThreadMain.</span></span><br><span class="line">Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</span><br><span class="line">Looper.loop();</span><br></pre></td></tr></table></figure>

<p>其它的都忽略，就看Looper相关的。<code>Looper.prepareMainLooper()</code>想必是达到了相同的效果吧。那么，这个效果到底是什么呢？让我们慢慢拨开云雾。</p>
<h2 id="寻找那个异常"><a href="#寻找那个异常" class="headerlink" title="寻找那个异常"></a>寻找那个异常</h2><p>于是，我们很自然地在子线程中加入了<code>Looper.prepare()</code>，并随手按着Ctrl，左键点击鼠标，进入了<code>prepare()</code>函数中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Initialize the current thread as a looper. This gives you a chance to create handlers that then reference this looper, before actually starting the loop. Be sure to call &#123;@link #loop()&#125; after calling this method, and end it by calling&#123;@link #quit()&#125;.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">prepare</span><span class="params">()</span> &#123;</span><br><span class="line">  	prepare(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">prepare</span><span class="params">(<span class="type">boolean</span> quitAllowed)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (sThreadLocal.get() != <span class="literal">null</span>) &#123;</span><br><span class="line">    	 <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Only one Looper may be created per thread&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sThreadLocal.set(<span class="keyword">new</span> <span class="title class_">Looper</span>(quitAllowed));</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">private</span> <span class="title function_">Looper</span><span class="params">(<span class="type">boolean</span> quitAllowed)</span> &#123;</span><br><span class="line">    mQueue = <span class="keyword">new</span> <span class="title class_">MessageQueue</span>(quitAllowed);</span><br><span class="line">    mThread = Thread.currentThread();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当初的那个异常不就在眼前？但是，这<code>sThreadLocal</code>又是什么？它是什么暂时抛开，这时我们知道了我们的线程中已经有了一个<code>Looper</code>，并且为这个Looper设置好了一个MessageQueue。因为一个线程只能有一个<code>Looper</code>，所以一个Looper也就只能拥有一个MessageQueue。但是AcitivityThread中，经过<code>Looper.loop()</code>后就再也没有下文了？所以，这个<code>loop()</code>又是干啥的呢？</p>
<h2 id="繁忙的loop"><a href="#繁忙的loop" class="headerlink" title="繁忙的loop()"></a>繁忙的<code>loop()</code></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Return the Looper object associated with the current thread.  Returns null if the calling thread is not associated with a Looper.*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="meta">@Nullable</span> Looper <span class="title function_">myLooper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> sThreadLocal.get();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Run the message queue in this thread. Be sure to call</span></span><br><span class="line"><span class="comment">* &#123;<span class="doctag">@link</span> #quit()&#125; to end the loop.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">loop</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Looper</span> <span class="variable">me</span> <span class="operator">=</span> myLooper();</span><br><span class="line">    <span class="keyword">if</span> (me == <span class="literal">null</span>) &#123;</span><br><span class="line">      	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;No Looper; Looper.prepare() wasn&#x27;t called on this thread.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">MessageQueue</span> <span class="variable">queue</span> <span class="operator">=</span> me.mQueue;</span><br><span class="line">	...</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="type">Message</span> <span class="variable">msg</span> <span class="operator">=</span> queue.next(); <span class="comment">// might block</span></span><br><span class="line">        <span class="keyword">if</span> (msg == <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="comment">// No message indicates that the message queue is quitting.</span></span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            msg.target.dispatchMessage(msg);</span><br><span class="line">            end = (slowDispatchThresholdMs == <span class="number">0</span>) ? <span class="number">0</span> : SystemClock.uptimeMillis();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (traceTag != <span class="number">0</span>) &#123;</span><br><span class="line">                Trace.traceEnd(traceTag);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">        msg.recycleUnchecked();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为其中一个大大的死循环，所以调用了<code>loop()</code>之后，其后就没有实际代码了。这个死循环就是用来处理Message，不断地从队列中取，然后不断地进行分发到相应的Handler，进行处理。<strong>此时，这个<code>for(;;)</code>所处的线程，就是你调用Looper.loop()时所在的线程。</strong>因此，它分发msg给了相应的Handler的handleMessage之后，还是在此线程中执行。然后，在想想，发送Message时所处在的线程，就焕然大悟这个异步操作了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Handle system messages here.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dispatchMessage</span><span class="params">(Message msg)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (msg.callback != <span class="literal">null</span>) &#123;</span><br><span class="line">        handleCallback(msg);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mCallback != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mCallback.handleMessage(msg)) &#123;</span><br><span class="line">              <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        handleMessage(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>handleMessage(msg)</code>不正是我们创建Handler时候，所覆盖的方法吗？</p>
<p>进一步思考，如果我只在主线程中new Handler，那么Looper就是主线程，所有的msg都会在主线程中被处理；那如果我想让msg在子线程中被处理呢？当然可以<code>Looper.prepare()</code>巴拉巴拉，然后<code>Looper.loop()</code>。但是Android还为我们提供了一个更为便捷的封装。那就是<code>HandlerThread</code>。</p>
<h2 id="子线程处理msg的封装HandlerThread"><a href="#子线程处理msg的封装HandlerThread" class="headerlink" title="子线程处理msg的封装HandlerThread"></a>子线程处理msg的封装HandlerThread</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    mTid = Process.myTid();</span><br><span class="line">    Looper.prepare();</span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123;</span><br><span class="line">        mLooper = Looper.myLooper();</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line">    Process.setThreadPriority(mPriority);</span><br><span class="line">    onLooperPrepared();</span><br><span class="line">    Looper.loop();</span><br><span class="line">    mTid = -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>源代码比较短。它继承自Thread，并在run方法中初始化好了Looper，可以通过其<code>getThreadHandler()</code>方法，获取到与该Looper所绑定的Handler，然后sendMessage()，最后在该线程中处理msg。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>因此，一个Thread可以有一个Looper和一个MessageQueue，一个Looper却可以与多个Handler绑定，但是一个Handler只能与一个Looper绑定。原因可以从Handler的构造方法中寻找的。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-10-18T23:14:42.000Z" title="10/19/2017, 7:14:42 AM">2017-10-19</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:14.870Z" title="2/9/2021, 11:03:14 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">29 分钟读完 (大约4416个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/10/19/29364bc7b465.html">Android中遇到的问题</a></p><div class="content"><blockquote>
<p>遇到了挺多的问题，但是每个问题都写篇文章感觉有点不实在，所以还是选择将这些小知识点都汇集到这一篇文章，方便自己再次查看吧。好多问题解决了之后没有及时记录下来，现在忘得差不多了。</p>
</blockquote>
<h2 id="替换Fragment的问题"><a href="#替换Fragment的问题" class="headerlink" title="替换Fragment的问题"></a>替换Fragment的问题</h2><blockquote>
<p>这个问题遇到过好几次了,但是还是没有很快地解决它.不过最终还是解决了~所以还是记下来踩过的坑吧</p>
</blockquote>
<hr>
<h4 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h4><p>代码如下. 在我们看来这可能是再平常不过的代码了,但是它就是报错了,而且就是在<code>replace</code>这个函数这里. 它需要的就是一个<code>Fragment</code>呀,我的<code>fragment</code>也是一个继承了<code>Fragment</code>类, 为什么就不能完成类型匹配呢? 所以很是纠结</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getFragmentManager().beginTransaction()</span><br><span class="line">                        .replace(R.id.container, fragment)</span><br><span class="line">                        .commit();</span><br></pre></td></tr></table></figure>
<p>但是,我心里清楚,我的fragment是继承自<code>android.support.v4.app.Fragment</code>, 而且我还记得之前使用过一个叫做<code>getSupportFragmentManager()</code>的方法, 但是为什么在这个<code>Activity</code>里面就是调用不出来! 气愤啊, 但是想到了一个叫做<code>AppCompatActivity</code>的适用性高的类, 因此只能想到是不是只有support类型的<code>Activity</code>才有<code>getSupportFragmentManager()</code>. 让宿主<code>Activity</code>继承<code>AppCompatActivity</code>, 最后调用出了<code>getSupportFragmentManager()</code>, 解决了这个莫名其妙的问题!</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li><code>FragmentManager</code>也有两种, 一个是<code>android.support.v4.app</code>包下的,一个是<code>android.app</code>包下的.</li>
<li>继承自<code>Activity</code>的活动里面,只能获取到<code>android.app.FragmentManager</code>; 继承自<code>AppCompatActivity</code>才可以获得<code>android.support.v4.app.FragmentManager</code></li>
<li>不同包下面的<code>FragmentManager</code>只能替换继承自同一个包下面的<code>Fragment</code>.</li>
<li>两个不同包下面的具体类如下所示</li>
</ul>
<p><img src="/images/pics/5ebad2c0e24796fca0b97b39aa0d2c52.png" alt="android.app包下的Fragment*"></p>
<p><img src="/images/pics/cce169639976380b54f346a4c1bf05be.png" alt="android.support.v4.app包下的Fragment*"></p>
<h2 id="Calendar中获取到的月份比实际月份少1"><a href="#Calendar中获取到的月份比实际月份少1" class="headerlink" title="Calendar中获取到的月份比实际月份少1"></a><code>Calendar</code>中获取到的月份比实际月份少1</h2><p>不算是bug吧。就像数组一样，月份也从0开始算。</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Field number for &lt;code&gt;get&lt;/code&gt; and &lt;code&gt;set&lt;/code&gt; indicating the</span></span><br><span class="line"><span class="comment"> * month. This is a calendar-specific value. The first month of</span></span><br><span class="line"><span class="comment"> * the year in the Gregorian and Julian calendars is</span></span><br><span class="line"><span class="comment"> * &lt;code&gt;JANUARY&lt;/code&gt; which is 0; the last depends on the number</span></span><br><span class="line"><span class="comment"> * of months in a year.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #JANUARY</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #FEBRUARY</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #MARCH</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #APRIL</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #MAY</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #JUNE</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #JULY</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #AUGUST</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #SEPTEMBER</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #OCTOBER</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #NOVEMBER</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #DECEMBER</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> #UNDECIMBER</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="SQLite中有两张表时出现SQLiteLog-1-no-such-table"><a href="#SQLite中有两张表时出现SQLiteLog-1-no-such-table" class="headerlink" title="SQLite中有两张表时出现SQLiteLog: (1) no such table"></a>SQLite中有两张表时出现<code>SQLiteLog: (1) no such table</code></h2><p>其实这个问题的出现，是对<code>SQLiteOpenHelper</code>没有了解清楚的一种表现。这段<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/21881993/8437428">回答</a>确实是醍醐灌顶。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html"><code>SQLiteOpenHelper</code></a> <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html#onCreate%28android.database.sqlite.SQLiteDatabase%29"><code>onCreate()</code></a> and <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html#onUpgrade%28android.database.sqlite.SQLiteDatabase,%20int,%20int%29"><code>onUpgrade()</code></a> callbacks are invoked when the database is actually opened, for example by a call to <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html#getWritableDatabase%28%29"><code>getWritableDatabase()</code></a>. The database is not opened when the database helper object itself is created.</p>
<p><code>SQLiteOpenHelper</code> versions the database files. The version number is the <code>int</code> argument passed to the <a target="_blank" rel="noopener" href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html#SQLiteOpenHelper%28android.content.Context,%20java.lang.String,%20android.database.sqlite.SQLiteDatabase.CursorFactory,%20int%29">constructor</a>. In the database file, the version number is stored in <a target="_blank" rel="noopener" href="http://www.sqlite.org/pragma.html#pragma_schema_version"><code>PRAGMA user_version</code></a>.</p>
<p><code>onCreate()</code> is only run when the database file did not exist and was just created. If <code>onCreate()</code>returns successfully (doesn’t throw an exception), the database is assumed to be created with the requested version number. As an implication, you should not catch <code>SQLException</code>s in <code>onCreate()</code>yourself.</p>
<p><code>onUpgrade()</code> is only called when the database file exists but the stored version number is lower than requested in constructor. The <code>onUpgrade()</code> should update the table schema to the requested version.</p>
<p>When changing the table schema in code (<code>onCreate()</code>), you should make sure the database is updated. Two main approaches:</p>
<ol>
<li>Delete the old database file so that <code>onCreate()</code> is run again. This is often preferred at development time where you have control over the installed versions and data loss is not an issue. Some ways to to delete the database file:<ul>
<li>Uninstall the application. Use the application manager or <code>adb uninstall your.package.name</code> from shell.</li>
<li>Clear application data. Use the application manager.</li>
</ul>
</li>
<li>Increment the database version so that <code>onUpgrade()</code> is invoked. This is slightly more complicated as more code is needed.<ul>
<li>For development time schema upgrades where data loss is not an issue, you can just use <code>execSQL(&quot;DROP TABLE IF EXISTS &lt;tablename&gt;&quot;)</code> in to remove your existing tables and call <code>onCreate()</code> to recreate the database.</li>
<li>For released versions, you should implement data migration in <code>onUpgrade()</code> so your users don’t lose their data.</li>
</ul>
</li>
</ol>
</blockquote>
<p>出现这样的错误的情景为：</p>
<p>有两张表，开始的时候创建了一个<code>**Helper</code>继承自<code>SQLiteOpenHelper</code>，然后又需要创建一张表的时候，又创建了一个类继承自<code>SQLiteOpenHelper</code>，里面的数据库名相同，版本号相同，只有表名、创建的SQL语句不同。这样做的原因是因为以为每次都会执行<code>onCreate()</code>，然后表就被创建了。这样的想法是错误的，根本就不是这么一回事。没有好好看过数据库相关的啊~ </p>
<p>在没看到这个回答之前，有过两次尝试，都解决了问题，但是为什么解决了，我竟然不知道！！</p>
<ul>
<li><p>尝试一：把两个数据库名改成不同的。这样就会在<code>/data/data/**/databases/</code>下面存在两个数据库文件。解决了问题。</p>
</li>
<li><p>尝试二：后来感觉可能与数据库的版本有关系，所以这次不改数据库名，但是将后者的版本号提高，并重载<code>onDowngrade()</code>方法，让它不干任何事情。</p>
</li>
<li><p>最终方案：将两个继承自<code>SQLiteOpenHelper</code>的类全部写到一个类里面，将另外一个删除掉。我觉得这是比较完美的解决方案，也大致明白了这背后的原因。好好地又上了一课。如下所示：</p>
<p><img src="/images/pics/e3e638bbc42829fe16428931db1de152.png" alt="代码展示"></p>
</li>
</ul>
<h2 id="WebView显示中文网页乱码"><a href="#WebView显示中文网页乱码" class="headerlink" title="WebView显示中文网页乱码"></a><code>WebView</code>显示中文网页乱码</h2><p>很久之前也遇到过这个问题，但是到现在记得的也就是可以通过设置某些参数，然后就可以正常显示中文了。</p>
<p>这次还是直接把这个它的设置方法贴出来吧，让自己不用再找了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">webView.getSettings().setDefaultTextEncodingName(<span class="string">&quot;UTF -8&quot;</span>);<span class="comment">//设置默认为utf-8</span></span><br><span class="line"><span class="comment">//webView.loadData(data, &quot;text/html&quot;, &quot;UTF -8&quot;); //API提供的标准用法，无法解决乱码问题</span></span><br><span class="line">webView.loadData(data, <span class="string">&quot;text/html; charset=UTF-8&quot;</span>, <span class="literal">null</span>);<span class="comment">//这种写法可以正确解码</span></span><br></pre></td></tr></table></figure>

<h2 id="String-replace-无法替换成功"><a href="#String-replace-无法替换成功" class="headerlink" title="String.replace()无法替换成功"></a><code>String.replace()</code>无法替换成功</h2><p>其实这个问题挺奇怪的，但是也算不上一个问题吧。</p>
<p><strong>这个方法并不会改变调用这个方法的String，而是返回一个替换了之后的String</strong></p>
<p>写着写着忘记了这个，结果浪费了好久的时间。</p>
<h2 id="RecyclerView如何创建ContextMenu"><a href="#RecyclerView如何创建ContextMenu" class="headerlink" title="RecyclerView如何创建ContextMenu"></a><code>RecyclerView</code>如何创建ContextMenu</h2><p>先上成功创建并获取到了所需信息的<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/27752974/8437428">链接</a>吧!</p>
<p>网上的说话基本上是ListView的，但是RecyclerView与它又不相同。因此按照网上的说法，基本上通过<code>getMenuInfo()</code>获取到的是空，好伤。如果不是空的话，那么会得到<code>AdapterView.AdapterContextMenuInfo</code>，这个里面包含了一些信息如position，应该是该项在整个RecyclerView中的位置吧。</p>
<p>网上的做法有两种，一种是：</p>
<ul>
<li>为ViewHolder设置<code>setOnCreateContextMenuListener()</code>，但是这样还是无法直接将所需要的信息传递进来，所以还需要设置<code>setOnMenuItemClickListener()</code>，用来处理点击该项后需要进行的事项，因此，这这里可以直接获取当前RecyclerView中的item并对其进行相关的操作。这个做法来自<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/33651696/8437428">链接</a>。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">itemView.setOnCreateContextMenuListener((menu, v, menuInfo) -&gt; &#123;</span><br><span class="line">    menu.add(<span class="string">&quot;稍后阅读&quot;</span>).setOnMenuItemClickListener(item -&gt; &#123;</span><br><span class="line">        Logger.e(easyNews.getNewsId());</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>可以参考这段代码，没有尝试过，但是mark一下吧！<a target="_blank" rel="noopener" href="http://www.jianshu.com/p/02c483518601">链接</a>，这种做法挺靠谱的感觉。</p>
<p>关键是下面这段代码，其余的可以按照ListView的那样进行操作。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RecyclerViewImplementsContextMenu</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> AdapterView.AdapterContextMenuInfo contextMenuInfo;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RecyclerViewImplementsContextMenu</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RecyclerViewImplementsContextMenu</span><span class="params">(Context context, <span class="meta">@Nullable</span> AttributeSet attrs)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RecyclerViewImplementsContextMenu</span><span class="params">(Context context, <span class="meta">@Nullable</span> AttributeSet attrs, <span class="type">int</span> defStyle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context, attrs, defStyle);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AdapterView.AdapterContextMenuInfo <span class="title function_">getContextMenuInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> contextMenuInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">showContextMenuForChild</span><span class="params">(View originalView)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">position</span> <span class="operator">=</span> getChildAdapterPosition(originalView);</span><br><span class="line">        <span class="type">long</span> <span class="variable">longId</span> <span class="operator">=</span> getChildItemId(originalView);</span><br><span class="line">        contextMenuInfo = <span class="keyword">new</span> <span class="title class_">AdapterView</span>.AdapterContextMenuInfo(originalView, position, longId);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.showContextMenuForChild(originalView);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Intent中如何传递一个普通对象"><a href="#Intent中如何传递一个普通对象" class="headerlink" title="Intent中如何传递一个普通对象"></a><code>Intent</code>中如何传递一个普通对象</h2><p>在做小应用的时候遇到了这种问题，网上的解答也比较完整。<br>方式一：Serializable 方式<br>使用Intent 来传递对象通常有两种实现方式，Serializable 和Parcelable，我们先来学习一下第一种的实现方式。<br>Serializable 是序列化的意思，表示将一个对象转换成可存储或可传输的状态。序列化后的对象可以在网络上进行传输，也可以存储到本地。至于序列化的方法也很简单，只需要让一个类去实现Serializable 这个接口就可以了。<br>比如说有一个Person 类，其中包含了name 和age 这两个字段，想要将它序列化就可以这样写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>&#123;  </span><br><span class="line"><span class="keyword">private</span> String name;  </span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> age;  </span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> name;  </span><br><span class="line">    &#125;  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.name = name;  </span><br><span class="line">    &#125;  </span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;  </span><br><span class="line">        <span class="keyword">return</span> age;  </span><br><span class="line">        &#125;  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;  </span><br><span class="line">        <span class="built_in">this</span>.age = age;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>其中get、set 方法都是用于赋值和读取字段数据的，最重要的部分是在第一行。这里让Person 类去实现了Serializable 接口，这样所有的Person 对象就都是可序列化的了。<br>接下来在FirstActivity 中的写法非常简单：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();  </span><br><span class="line">person.setName(<span class="string">&quot;Tom&quot;</span>);  </span><br><span class="line">person.setAge(<span class="number">20</span>);  </span><br><span class="line"><span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(FirstActivity.<span class="built_in">this</span>, SecondActivity.class);  </span><br><span class="line">intent.putExtra(<span class="string">&quot;person_data&quot;</span>, person);  </span><br><span class="line">startActivity(intent);  </span><br></pre></td></tr></table></figure>
<p>可以看到，这里我们创建了一个Person 的实例，然后就直接将它传入到putExtra()方法中了。由于Person 类实现了Serializable 接口，所以才可以这样写。<br>接下来在SecondActivity 中获取这个对象也很简单，写法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> (Person) getIntent().getSerializableExtra(<span class="string">&quot;person_data&quot;</span>);  </span><br></pre></td></tr></table></figure>
<p>这里调用了getSerializableExtra()方法来获取通过参数传递过来的序列化对象，接着再将它向下转型成Person 对象，这样我们就成功实现了使用Intent 来传递对象的功能了。</p>
<p>方式二：Parcelable<br>除了Serializable 之外，使用Parcelable 也可以实现相同的效果，不过不同于将对象进行序列化，Parcelable 方式的实现原理是将一个完整的对象进行分解，而分解后的每一部分都是Intent 所支持的数据类型，这样也就实现传递对象的功能了。<br>下面我们来看一下Parcelable 的实现方式，修改Person 中的代码，如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Parcelable</span> &#123;  </span><br><span class="line">    <span class="keyword">private</span> String name;  </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;  </span><br><span class="line">      </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">describeContents</span><span class="params">()</span> &#123;  </span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeToParcel</span><span class="params">(Parcel dest, <span class="type">int</span> flags)</span> &#123;  </span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">        dest.writeString(name);  </span><br><span class="line">        dest.writeInt(age);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Parcelable.Creator&lt;Person&gt; CREATOR=<span class="keyword">new</span> <span class="title class_">Parcelable</span>.Creator&lt;Person&gt;() &#123;  </span><br><span class="line">  </span><br><span class="line">        <span class="meta">@Override</span>  </span><br><span class="line">        <span class="keyword">public</span> Person <span class="title function_">createFromParcel</span><span class="params">(Parcel source)</span> &#123;  </span><br><span class="line">            <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">            Person person=<span class="keyword">new</span> <span class="title class_">Person</span>();  </span><br><span class="line">            person.name=source.readString();  </span><br><span class="line">            person.age=source.readInt();  </span><br><span class="line">            <span class="keyword">return</span> person;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="meta">@Override</span>  </span><br><span class="line">        <span class="keyword">public</span> Person[] newArray(<span class="type">int</span> size) &#123;  </span><br><span class="line">            <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Person</span>[size];  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;;  </span><br><span class="line">  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p>Parcelable 的实现方式要稍微复杂一些。可以看到，首先我们让Person 类去实现了Parcelable 接口，这样就必须重写describeContents()和writeToParcel()这两个方法。其中describeContents()方法直接返回0 就可以了，而writeToParcel()方法中我们需要调用Parcel的writeXxx()方法将Person 类中的字段一一写出。注意字符串型数据就调用writeString()方法，整型数据就调用writeInt()方法，以此类推。<br>除此之外，我们还必须在Person 类中提供一个名为CREATOR 的常量，这里创建了Parcelable.Creator 接口的一个实现，并将泛型指定为Person。接着需要重写createFromParcel()和newArray()这两个方法，在createFromParcel()方法中我们要去读取刚才写出的name 和age字段，并创建一个Person 对象进行返回，其中name 和age 都是调用Parcel 的readXxx()方法读取到的，注意这里读取的顺序一定要和刚才写出的顺序完全相同。而newArray()方法中的实现就简单多了，只需要new 出一个Person 数组，并使用方法中传入的size 作为数组大小就可以了。<br>接下来在FirstActivity 中我们仍然可以使用相同的代码来传递Person 对象，只不过在SecondActivity 中获取对象的时候需要稍加改动，如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> (Person) getIntent().getParcelableExtra(<span class="string">&quot;person_data&quot;</span>);  </span><br></pre></td></tr></table></figure>
<p>注意这里不再是调用getSerializableExtra()方法，而是调用getParcelableExtra()方法来获取传递过来的对象了，其他的地方都完全相同。这样我们就把使用Intent 来传递对象的两种实现方式都学习完了，对比一下，Serializable的方式较为简单，但由于会把整个对象进行序列化，因此效率方面会比Parcelable 方式低一些，所以在通常情况下还是更加推荐使用Parcelable 的方式来实现Intent 传递对象的功能。</p>
<blockquote>
<p>作为一名Android开发人员，时常遇到Android Studio抽风的情况。之前也遇到过，没有记录，之后就忘了，还得去重新去查解决办法，真的是有点痛心疾首。所以在这里特地记录下，在开发过程中，所遇到的一些关于AS的一些问题，让自己进步得更快。</p>
</blockquote>
<h2 id="Error-type-3-as中更换包名后出现的问题"><a href="#Error-type-3-as中更换包名后出现的问题" class="headerlink" title="Error type 3 as中更换包名后出现的问题"></a>Error type 3 as中更换包名后出现的问题</h2><p><img src="/images/pics/9c07a0e1b54dbab263d9d620c96b7e22.png" alt="离奇事件的现场图"></p>
<h4 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h4><p><strong>修改了原本的包名</strong>.</p>
<h4 id="现象1"><a href="#现象1" class="headerlink" title="现象1"></a>现象1</h4><p>之后R文件也出现了问题, 这个现场截图已经找不到了, 大致是这样的. 所有代码中应用了R文件的地方都出现了错误,并且将鼠标移到其上,可以通过<code>Alt + Enter</code>导入R文件.<br>但是这个R文件是上一个包名下的R文件, 导入了也没用, 还是该报错的地方报错. 后来, 找到了<code>Manifest.xml</code>文件中的<code>package</code>  属性, 发现它是修改包名之前的包名, 所以改了之后, rebuild了一下, 就解决了<br><img src="/images/pics/8db0e7e7d3c5837570f48cbdbef4b0e0.png" alt="修改这里就好啦"></p>
<h4 id="现象2"><a href="#现象2" class="headerlink" title="现象2"></a>现象2</h4><p>如上图所示. 所有的代码基本上修改好了, 开开心心的点了一下Run,结果给了我一大段红色的error…面对这个确实也比较无奈.我感觉这个应该与应用配置有关系, 也就是与那一堆<code>Gradle Scripts</code>有关系, 但是不知道该修改哪里的哪个参数.不过网上还是有比我先遇到这个问题的人, 解决方案也有了~如下:</p>
<blockquote>
<p>I had the same error after renaming&#x2F;refactoring. What I did was add the applicationId property attribute to my build.gradle file, and set its value to the application package. Like this:</p>
</blockquote>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android&#123;</span><br><span class="line">    defaultConfig&#123;</span><br><span class="line">        applicationId <span class="string">&quot;com.example.mypackage&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>from</em> <a target="_blank" rel="noopener" href="https://stackoverflow.com/a/25633427/8437428">Stack Overflow</a> </p>
<h2 id="Enable-Jack"><a href="#Enable-Jack" class="headerlink" title="Enable Jack"></a>Enable Jack</h2><p>直接上方法吧。引用自：<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/36880536/8437428">Stackoverflow</a></p>
<p>The details on what is required to use Jack and how can be found in the <a target="_blank" rel="noopener" href="https://developer.android.com/guide/platform/j8-jack.html#configure-gradle">documentation</a>.</p>
<p>Here is the relevant part from the docs that goes in build.gradle on how to use jackOptions and set the compileOptions for java 1.8.</p>
<p>android {<br>    …<br>    defaultConfig {<br>        …<br>        jackOptions {<br>            enabled true<br>        }<br>    }</p>
<pre><code>compileOptions &#123;
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
&#125;
</code></pre>
<p>}<br>UPDATE</p>
<p>The Jack toolchain is now considered deprecated according to this <a target="_blank" rel="noopener" href="https://android-developers.googleblog.com/2017/03/future-of-java-8-language-feature.html">post</a> and work is being done to natively support Java 8 features as part of the Android build system in the coming weeks according to the post.</p>
<p>The post also mentions that there should be little to no work migrating from Jack to the new method in case you still wanted to try enabling Java 8 features with Jack.</p>
<p>UPDATE 2 Preview Built-in Support</p>
<p>You can now try out the new built-in support for Java 8 using the latest Android Studio preview 2.4 preview 6.</p>
<p>For more information on how to enable it or migrate from Jack or Retrolambda see the <a target="_blank" rel="noopener" href="https://developer.android.com/studio/preview/features/java8-support.html">documentation</a>.</p>
<h2 id="Gradle版本降级"><a href="#Gradle版本降级" class="headerlink" title="Gradle版本降级"></a>Gradle版本降级</h2><p>导入<code>TO-DO-MVP</code>这个Google官方给的例子时，需要把Android Studio的Gradle插件版本从3.0.0-alpha4的版本降为 2.3.3。操作时，碰到了一个问题如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error:(28, 0) Could not find method implementation() for arguments [com.android.support:appcompat-v7:25.3.1] on object of type org.gradle.api.internal.artifacts.dsl.dependencies.DefaultDependencyHandler.</span><br><span class="line">Please install the Android Support Repository from the Android SDK Manager.</span><br><span class="line">&lt;a href=&quot;openAndroidSdkManager&quot;&gt;Open Android SDK Manager&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<p>其实这两个版本间Gradle的一些关键词有一些不同，改回2.3.3之后，需要将关键词也改回来。有点想吐槽~这都不兼容了！</p>
<p>基本上是把<code>Iementation</code>改回<code>Compile</code>就好了，注意一些地方的大小写。</p>
<h2 id="Android-Studio显示No-debuggable-process"><a href="#Android-Studio显示No-debuggable-process" class="headerlink" title="Android Studio显示No debuggable process"></a>Android Studio显示No debuggable process</h2><p>正在开发的程序已经被运行起来了，可是这里却显示没有debuggable process。<br><img src="/images/pics/e71528919e7e0856f3f4369da9300c02.png" alt="现场"></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/26593927/android-studio-no-debuggable-applications">修改方法</a>真的是一语道破天机啊~</p>
<blockquote>
<p>You also should have Tools-&gt;Android-&gt;Enable ADB Integration active.</p>
</blockquote>
<h2 id="Android-Studio中Error-String-index-out-of-range-0"><a href="#Android-Studio中Error-String-index-out-of-range-0" class="headerlink" title="Android Studio中Error:String index out of range: 0"></a>Android Studio中Error:String index out of range: 0</h2><p><img src="/images/pics/02cfa1fe6b1f28c671213ac9610b1641.png" alt="现场"></p>
<p>出现这种错误有点莫名其妙，<a target="_blank" rel="noopener" href="http://blog.csdn.net/zhufuing/article/details/48830305">网上</a>上的解释是values下面的文件有出错的情况，检查了每个文件，都没出现<code>&lt;string name=&quot;&quot;&gt;&lt;/string&gt; </code>这种类型的情况。很是苦恼，网上的说法也基本上与此种情况类似。<br>在检查到<code>gradle.properties</code>这个配置文件的时候，发现了git无法自动合并而让我们手动解决合并冲突的痕迹，而此冲突却并没有被手动解决。如下图所示：</p>
<p><img src="/images/pics/9af924932f6db45f655fe7bf61192abd.png" alt="祸首"></p>
<p>删掉了不必要的东西之后，一切正常。</p>
<p>出现这种错误，有点不应该。但是同时也说明了，网上的东西只能当参考啊！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2017-10-10T00:21:03.000Z" title="10/10/2017, 8:21:03 AM">2017-10-10</time>发表</span><span class="level-item"><time dateTime="2022-04-20T16:09:03.342Z" title="4/21/2022, 12:09:03 AM">2022-04-21</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Android/">Android</a></span><span class="level-item">7 分钟读完 (大约1099个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/10/10/09fad02370c0.html">通过hierarchyview探寻flowlayout</a></p><div class="content">前言在开发过程中遇到了一个很熟悉的控件，但是我不知道它叫啥名字，并且也不知道该用什么样的语言去描述它。然而，我却在很多的应用中看到了它的身影，QQ音乐，YouTube等，如下图所示：为了一探究竟，我猜想它属于RecyclerView，是RecyclerView的一种定制化。通过勾选开发者选项中的显示</div><a class="article-more button is-small is-size-7" href="/2017/10/10/09fad02370c0.html#more">阅读更多</a></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/tags/Android/">上一页</a></div><div class="pagination-next is-invisible is-hidden-mobile"><a href="/tags/Android/page/3/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/tags/Android/">1</a></li><li><a class="pagination-link is-current" href="/tags/Android/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/12/"><span class="level-start"><span class="level-item">十二月 2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">二月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">一月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">一月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">四月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">十一月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">十月 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">七月 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">六月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">四月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">三月 2019</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/02/"><span class="level-start"><span class="level-item">二月 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/01/"><span class="level-start"><span class="level-item">一月 2019</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/12/"><span class="level-start"><span class="level-item">十二月 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">十一月 2018</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">九月 2018</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">八月 2018</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/07/"><span class="level-start"><span class="level-item">七月 2018</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/06/"><span class="level-start"><span class="level-item">六月 2018</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/05/"><span class="level-start"><span class="level-item">五月 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/04/"><span class="level-start"><span class="level-item">四月 2018</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/03/"><span class="level-start"><span class="level-item">三月 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/02/"><span class="level-start"><span class="level-item">二月 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/01/"><span class="level-start"><span class="level-item">一月 2018</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/12/"><span class="level-start"><span class="level-item">十二月 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/10/"><span class="level-start"><span class="level-item">十月 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/09/"><span class="level-start"><span class="level-item">九月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/03/"><span class="level-start"><span class="level-item">三月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/01/"><span class="level-start"><span class="level-item">一月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/12/"><span class="level-start"><span class="level-item">十二月 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/249b2dc63505.html"><img src="/images/pics/5300c911560a8d2e0d745dcaf025d22f.jpg" alt="M系列MacBook连接l2tp时失败的问题修复"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/249b2dc63505.html">M系列MacBook连接l2tp时失败的问题修复</a></p><p class="categories"><a href="/categories/macOS/">macOS</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/e9036e8500f6.html"><img src="/images/thumbnails/rust-lang.png" alt="Rust学习笔记"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/e9036e8500f6.html">Rust学习笔记</a></p><p class="categories"><a href="/categories/Rust/">Rust</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/b0874d97f2ec.html"><img src="/images/pics/8a16be7bbc191e48a6e5b08755f591ec.png" alt="01.AI概览"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/b0874d97f2ec.html">01.AI概览</a></p><p class="categories"><a href="/categories/AI/">AI</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/4948e86c1262.html"><img src="/images/pics/DrRvr9.jpg" alt="Calico证书学习笔记"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/4948e86c1262.html">Calico证书学习笔记</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/6dae87e31dc3.html"><img src="/images/pics/e9f22d889a230bfda8e24c0a981740a8.png" alt="如何在YAML文件中进行优雅地换行"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/6dae87e31dc3.html">如何在YAML文件中进行优雅地换行</a></p><p class="categories"><a href="/categories/Golang/">Golang</a></p></div></article></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://crisfang.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Cris</span></span><span class="level-right"><span class="level-item tag">crisfang.com</span></span></a></li><li><a class="level is-mobile" href="https://sanyuesha.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">三月沙</span></span><span class="level-right"><span class="level-item tag">sanyuesha.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png" alt="遇寻笔记" height="28"></a><p class="is-size-7"><span>&copy; 2024 遇寻</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="To Find Me" href="https://github.com/eucham"><i class="fab fa-github"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/eucham"><i class="fab fa-linkedin"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>