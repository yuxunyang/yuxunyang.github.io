<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>分类: 数据库 - 遇寻笔记</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="遇寻笔记"><meta name="msapplication-TileImage" content="/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="遇寻笔记"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="No. I&amp;#39;ll bring me back a souvenir."><meta property="og:type" content="website"><meta property="og:title" content="遇寻笔记"><meta property="og:url" content="https://eucham.me/"><meta property="og:site_name" content="遇寻笔记"><meta property="og:description" content="No. I&amp;#39;ll bring me back a souvenir."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://eucham.me/img/og_image.png"><meta property="article:author" content="遇寻"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://eucham.me/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://eucham.me"},"headline":"遇寻笔记","image":["https://eucham.me/img/og_image.png"],"author":{"@type":"Person","name":"遇寻"},"publisher":{"@type":"Organization","name":"遇寻笔记","logo":{"@type":"ImageObject","url":"https://eucham.me/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png"}},"description":"No. I&#39;ll bring me back a souvenir."}</script><link rel="icon" href="/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?7d79380bb26079f6dd33da78e83cf2ab";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png" alt="遇寻笔记" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/categories/AI">AI</a><a class="navbar-item" href="/categories/Kubernetes">Kubernetes</a><a class="navbar-item" href="/categories/Openstack">Openstack</a><a class="navbar-item" href="/categories/Docker">Container</a><a class="navbar-item" href="/categories/Golang">Golang</a><a class="navbar-item" href="/categories/Rust">Rust</a><a class="navbar-item" href="/about.html">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="To Find Me" href="https://github.com/eucham"><i class="fab fa-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/eucham"><i class="fab fa-linkedin"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">分类</a></li><li class="is-active"><a href="#" aria-current="page">数据库</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-10-04T15:57:15.000Z" title="10/4/2020, 11:57:15 PM">2020-10-04</time>发表</span><span class="level-item"><time dateTime="2022-04-20T16:35:05.459Z" title="4/21/2022, 12:35:05 AM">2022-04-21</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">3 分钟读完 (大约465个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/10/04/8af25a958664.html">MySQL简易入门</a></p><div class="content">MySQL 是一个互联网绕不过去的坎，总觉得很简单，一切似乎都围绕着 CURD，但是不能脱离这个核心，本次的博客其 MySQL 的一些基本概念作为主题，力求用自己的语言，将其中的概念说清楚。今天是在银川的第二天，第一次坐完飞机，现在在见家长的过程中，偷得片刻悠闲，写点东西作为总结~一条SQL的执行流</div><a class="article-more button is-small is-size-7" href="/2020/10/04/8af25a958664.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-12-16T01:43:51.000Z" title="12/16/2019, 9:43:51 AM">2019-12-16</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:27.815Z" title="2/9/2021, 11:03:27 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">1 分钟读完 (大约164个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/12/16/cbd6ae13640b.html">MySQL备份记录</a></p><div class="content"><h2 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h2><p>命令行下具体用法如下： </p>
<p><code>mysqldump -u用戶名 -p密码 -d 数据库名 表名 &gt; 脚本名</code>;</p>
<p>导出整个数据库结构和数据<br><code>mysqldump -h localhost -uroot -p123456 database &gt; dump.sql</code></p>
<p>导出单个数据表结构和数据<br><code>mysqldump -h localhost -uroot -p123456  database table &gt; dump.sql</code></p>
<p>导出整个数据库结构（不包含数据）<br><code>mysqldump -h localhost -uroot -p123456  -d database &gt; dump.sql</code></p>
<p>导出单个数据表结构（不包含数据）<br><code>mysqldump -h localhost -uroot -p123456  -d database table &gt; dump.sql</code></p>
<h2 id="数据还原"><a href="#数据还原" class="headerlink" title="数据还原"></a>数据还原</h2><p>1、还原使用mysqldump命令备份的数据库的语法如下：<br><code>mysql -u root -p [dbname] &lt; backup.sq</code></p>
<p>示例：<br><code>mysql -u root -p &lt; C:\backup.sql</code></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-04-19T23:38:16.000Z" title="4/20/2019, 7:38:16 AM">2019-04-20</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:04:01.531Z" title="2/9/2021, 11:04:01 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">2 分钟读完 (大约360个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/04/20/f6a218b8160a.html">MySQL查询卡死、无返回结果问题解决</a></p><div class="content"><h2 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h2><p>①在Navicat中，修改表结构，点击保存，然后发现Navicat卡住，无法正常退出，且MySQL无数据返回。<br>②在任务管理器中强制关闭了Navicat后，重复在Navicat中尝试几次，结果仍然一样。<br>③在MySQL CLI中进行select查询，同样卡住。</p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>起初认为是网络问题，但是想到<strong>可能是被堵塞住</strong>了。</p>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>查询MySQL中的进程：<code>show processlist</code>。</p>
<p>打开正在进行中的进程列表，发现有<code>Waiting for table metadata lock</code>，所以初步判定是因为某个操作被堵塞，然后后续操作无法执行，从而引起了这个问题。</p>
<p>从网上的资料看来，可能的原因是有<strong>未提交事物，阻塞DDL，继而阻塞所有同表的后续操作</strong>；结合自己对此数据库的操作，初步认为是在自己的小项目里面，可能存在上述情况。</p>
<p>查看未提交的事务：<code>select trx_state, trx_started, trx_mysql_thread_id, trx_query from information_schema.innodb_trx\G</code></p>
<p>执行后，发现确实存在未提交的事务。</p>
<p>kill掉未提交的事务，返回到Navicat，发现 <del>之前卡住的操作</del><strong>已完成</strong>。</p>
<p><strong>【参考】</strong><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/benben683280/article/details/78799010">https://blog.csdn.net/benben683280/article/details/78799010</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013235478/article/details/68062939">https://blog.csdn.net/u013235478/article/details/68062939</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/digdeep/p/4892953.html">https://www.cnblogs.com/digdeep/p/4892953.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-03-20T00:38:33.000Z" title="3/20/2019, 8:38:33 AM">2019-03-20</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:52.714Z" title="2/9/2021, 11:03:52 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span> / </span><a class="link-muted" href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/">后端开发</a></span><span class="level-item">5 分钟读完 (大约785个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/03/20/5156767b418e.html">解决web端登录时等待过久并偶尔抛出事务相关异常</a></p><div class="content"><h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p><img src="/images/pics/b121bd559df52a004b45e06e2cc88495.png" alt="在这里插入图片描述"></p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>登录函数中有一个事务，如下：<br><img src="/images/pics/0608cdfe9b3f587c7bcf75a95a61f312.png" alt="在这里插入图片描述"><br>事务里面有一个有可能操作比较耗时的过程：<br><img src="/images/pics/c48cc071a374cc675606da7556e12130.png" alt="在这里插入图片描述"><br>在新增登录日志的时候，获取用户的ip。<br><img src="/images/pics/7eb2aaf28af964507dc55b2cb69d18a2.png" alt="在这里插入图片描述"><br>具体干了啥不重要，重要的是发了一个http请求，并且是串行的，所以这个请求比较耗时的可能是很大的，并且具备不确定性因素。<br><img src="/images/pics/30bb080b6e51b36241ad15dcc01c8ef4.png" alt="在这里插入图片描述"></p>
<h2 id="反思"><a href="#反思" class="headerlink" title="反思"></a>反思</h2><p><code>TransactionRollbackException</code>的文档注释为：</p>
<p><em>This exception indicates that the transaction associated with processing of the request has been rolled back, or marked to roll back. Thus the requested operation either could not be performed or was not performed because further computation on behalf of the transaction would be fruitless</em></p>
<p>可能的过程为：线程1进入事务、然后进行了一次update操作，获得了一个排他锁，然后被卡在了获取ip的那个地方，即此事务持有着排他锁，然后还长时间不结束（50s+），然后线程2也进入了事务，此时在进行update的时候，需要等待线程1释放排它锁，在50秒过后，仍未获取到锁，此时获取锁时间超过了预设，抛出上述异常。</p>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>规避潜在的耗时操作。<strong>但是由于此服务没人维护，因此通过本地编译，然后拉包替换相应class文件，再上传到服务器的方式进行修改。</strong></p>
<h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><p>查看获取锁的超时阀值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;%timeout%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>输出如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+----------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name               <span class="operator">|</span> <span class="keyword">Value</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+----------+</span></span><br><span class="line"><span class="operator">|</span> connect_timeout             <span class="operator">|</span> <span class="number">10</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> delayed_insert_timeout      <span class="operator">|</span> <span class="number">300</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> have_statement_timeout      <span class="operator">|</span> YES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> innodb_flush_log_at_timeout <span class="operator">|</span> <span class="number">1</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> innodb_lock_wait_timeout    <span class="operator">|</span> <span class="number">50</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> innodb_rollback_on_timeout  <span class="operator">|</span> OFF      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> interactive_timeout         <span class="operator">|</span> <span class="number">28800</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> lock_wait_timeout           <span class="operator">|</span> <span class="number">31536000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> net_read_timeout            <span class="operator">|</span> <span class="number">30</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> net_write_timeout           <span class="operator">|</span> <span class="number">60</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> rpl_stop_slave_timeout      <span class="operator">|</span> <span class="number">31536000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> slave_net_timeout           <span class="operator">|</span> <span class="number">60</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> wait_timeout                <span class="operator">|</span> <span class="number">28800</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+----------+</span></span><br><span class="line"><span class="number">13</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --------------------------Controller------------</span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 测试web端登录锁表</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@GetMapping(&quot;/hotline/test&quot;)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSomeThing</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    testService.doSomething();</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// ----------------------------Service----------------</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestService</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> BizConfMapper confMapper;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="comment">// 共享锁</span></span><br><span class="line">    <span class="type">BizConf</span> <span class="variable">conf</span> <span class="operator">=</span> confMapper.selectByPrimaryKey(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 排它锁</span></span><br><span class="line">    confMapper.updateByPrimaryKey(conf);</span><br><span class="line">    <span class="comment">// 等待让下个线程超时，最起码要大于50</span></span><br><span class="line">    Thread.sleep(<span class="number">60000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>日志输出与项目中出现的错误信息基本一致，如下：<br><img src="/images/pics/3be7b45fa1d895fd19656ba7b1a932cd.png" alt="在这里插入图片描述"><br>在<code>@Transactional</code>注解中加入timeout后，报错不一样，但是阔以理解为spring框架为我们抛出了异常。如下：<br><img src="/images/pics/1cfe80e7355ec2e1ff68cb468b0c96bb.png" alt="在这里插入图片描述"></p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>其中对我理解这种现象有很大帮助的资料为这一张图，它让我明白了锁与事务之间的关系。<br><img src="/images/pics/9bebe9ada738c3908c5baa7df6041ae8.png" alt="在这里插入图片描述"><br>参考：<br><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000014133576">https://segmentfault.com/a/1190000014133576</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-01-01T04:21:42.000Z" title="1/1/2019, 12:21:42 PM">2019-01-01</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:47.030Z" title="2/9/2021, 11:03:47 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">14 分钟读完 (大约2030个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/01/01/ad599b882728.html">Oracle安装&amp;实用过程中遇到的问题</a></p><div class="content"><h2 id="安装ORACLE-11G-出现：“-INS-32025-所选安装与指定-Oracle-主目录中已安装的软件冲突”-的问题"><a href="#安装ORACLE-11G-出现：“-INS-32025-所选安装与指定-Oracle-主目录中已安装的软件冲突”-的问题" class="headerlink" title="安装ORACLE 11G 出现：“[INS-32025] 所选安装与指定 Oracle 主目录中已安装的软件冲突” 的问题"></a>安装ORACLE 11G 出现：“[INS-32025] 所选安装与指定 Oracle 主目录中已安装的软件冲突” 的问题</h2><p>参考了网上的一些教程，但是没有在C:\Program Files (x86)下面找到相关文件，但是却在C:\Program Files下找到了相关文件，可能与我之前安装。如下：<br><img src="/images/pics/93022fa9514caff5533f531d7cdce0f4.png" alt="在这里插入图片描述"><br>删除Oracle\Inventory\ContentsXML目录下的inventory.xml 文件即可。</p>
<h2 id="Oracle中的分页查询"><a href="#Oracle中的分页查询" class="headerlink" title="Oracle中的分页查询"></a>Oracle中的分页查询</h2><p>oracle中的分页没有mysql容易，mysql只需要实用limit关键字就行，oracle中需要使用隐含列rownum，来进行分页。其中rownum是指：<strong>符合要求的列数的序号，从1开始</strong>，即先进行了where语句后，赛选出来的行数。如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> rownum rn,</span><br><span class="line">		<span class="operator">&lt;</span>include refid<span class="operator">=</span>&quot;Haylion_Column_List&quot;<span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">	<span class="keyword">FROM</span></span><br><span class="line">		m_qr_offline_consume_reg_hay</span><br><span class="line">	<span class="keyword">WHERE</span></span><br><span class="line">		TRANS_DATE <span class="operator">&gt;</span> to_date(#&#123;<span class="type">date</span>&#125;, #&#123;template&#125;) <span class="keyword">and</span> trans_date <span class="operator">&lt;</span> (sysdate <span class="operator">-</span> <span class="number">1</span> <span class="operator">/</span> (<span class="number">25</span> <span class="operator">*</span> <span class="number">60</span>) <span class="operator">*</span> #&#123;delay&#125;)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">where</span> rn <span class="keyword">between</span> #&#123;startIdx&#125; <span class="keyword">and</span> #&#123;endIdx&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Oracle查看版本"><a href="#Oracle查看版本" class="headerlink" title="Oracle查看版本"></a>Oracle查看版本</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v$version;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> product_component_version;</span><br></pre></td></tr></table></figure>

<h2 id="Oracle中基本概念"><a href="#Oracle中基本概念" class="headerlink" title="Oracle中基本概念"></a>Oracle中基本概念</h2><h3 id="数据库名"><a href="#数据库名" class="headerlink" title="数据库名"></a>数据库名</h3><p>什么是数据库名？ 数据库名就是一个数据库的标识，就像人的身份证号一样。他用参数DB_NAME表示，如果一台机器上装了多全数据库，那么每一个数据库都有一个数据库名。在数据库安装或创建完成之后，参数DB_NAME被写入参数文件之中。格式如下： DB_NAME&#x3D;myorcl … 在 创建数据库时就应考虑好数据库名，并且在创建完数据库之后，数据库名不宜修改，即使要修改也会很麻烦。因为，数据库名还被写入控制文件中，控制文件是以 二进制型式存储的，用户无法修改控制文件的内容。假设用户修改了参数文件中的数据库名，即修改DB_NAME的值。但是在Oracle启动时，由于参数文 件中的DB_NAME与控制文件中的数据库名不一致，导致数据库启动失败，将返回ORA-01103错误。</p>
<p>数据库名的作用 数据库名是在安装数据库、创建新的数据库、创建数据库控制文件、修改数据结构、备份与恢复数据库时都需要使用到的。 有很多Oracle安装文件目录是与数据库名相关的，如： winnt: d:&#x2F;oracle&#x2F;product&#x2F;10.1.0&#x2F;oradata&#x2F;DB_NAME&#x2F;… Unix: &#x2F;home&#x2F;app&#x2F;oracle&#x2F;product&#x2F;10.1.0&#x2F;oradata&#x2F;DB_NAME&#x2F;… pfile: winnt: d:&#x2F;oracle&#x2F;product&#x2F;10.1.0&#x2F;admin&#x2F;DB_NAME&#x2F;pfile&#x2F;ini.ora Unix: &#x2F;home&#x2F;app&#x2F;oracle&#x2F;product&#x2F;10.1.0&#x2F;admin&#x2F;DB_NAME&#x2F;pfile&#x2F;init$ORACLE_SID.ora 跟踪文件目录： winnt: &#x2F;home&#x2F;app&#x2F;oracle&#x2F;product&#x2F;10.1.0&#x2F;admin&#x2F;DB_NAME&#x2F;bdump&#x2F;… 另外，在创建数据时，careate database命令中的数据库名也要与参数文件中DB_NAME参数的值一致，否则将产生错误。 同样，修改数据库结构的语句alter database， 当然也要指出要修改的数据库的名称。 如果控制文件损坏或丢失，数据库将不能加载，这时要重新创建控制文件，方法是以nomount方式启动实例，然后以create controlfile命令创建控制文件，当然这个命令中也是指指DB_NAME。 还有在备份或恢复数据库时，都需要用到数据库名。 总之，数据库名很重要，要准确理解它的作用。</p>
<p>查询当前数据名 方法一:<code>select name from v$database</code>; 方法二：<code>show parameter db</code> 方法三：查看参数文件。</p>
<p>修改数据库名 前面建议：应在创建数据库时就确定好数据库名，数据库名不应作修改，因为修改数据库名是一件比较复杂的事情。那么现在就来说明一下，如何在已创建数据之后，修改数据库名。步骤如下：<br>1.关闭数据库。<br>2.修改数据库参数文件中的DB_NAME参数的值为新的数据库名。<br>3.以NOMOUNT方式启动实例，修建控制文件(有关创建控制文件的命令语法，请参考oracle文档)</p>
<h3 id="数据库实例名"><a href="#数据库实例名" class="headerlink" title="数据库实例名"></a>数据库实例名</h3><p>什么是数据库实例名？ 数据库实例名是用于和操作系统进行联系的标识，就是说数据库和操作系统之间的交互用的是数据库实例名。实例名也被写入参数文件中，该参数为instance_name，在winnt平台中，实例名同时也被写入注册表。 数据库名和实例名可以相同也可以不同。 在一般情况下，数据库名和实例名是一对一的关系，但如果在oracle并行服务器架构(即oracle实时应用集群)中，数据库名和实例名是一对多的关系。这一点在第一篇中已有图例说明。</p>
<p>查询当前数据库实例名<br>方法一：<code>select instance_name from v$instance</code>;<br>方法二：<code>show parameter instance</code><br>方法三：在参数文件中查询。</p>
<p>数据库实例名与ORACLE_SID 虽 然两者都表是oracle实例，但两者是有区别的。instance_name是oracle数据库参数。而ORACLE_SID是操作系统的环境变 量。 ORACLD_SID用于与操作系统交互，也就是说，从操作系统的角度访问实例名，必须通过ORACLE_SID。在winnt不台， ORACLE_SID还需存在于注册表中。 且ORACLE_SID必须与instance_name的值一致，否则，你将会收到一个错误，在unix平台，是“ORACLE not available”,在winnt平台，是“TNS:协议适配器错误”。</p>
<p>数据库实例名与网络连接</p>
<p>数据库实例名除了与操作系统交互外，还用于网络连接的oracle服务器标识。当你配置oracle主机连接串的时候，就需要指定实例名。当然8i以后版本的网络组件要求使用的是服务名SERVICE_NAME。这个概念接下来说明 。</p>
<h3 id="数据库域名"><a href="#数据库域名" class="headerlink" title="数据库域名"></a>数据库域名</h3><p>什么是数据库域名？ 在分布工数据库系统中，不同版本的数据库服务器之间，不论运行的操作系统是unix或是windows，各服务器之间都可以通过数据库链路进行远程复制，数据库域名主要用于oracle分布式环境中的复制。举例说明如： 全国交通运政系统的分布式数据库，其中： 福建节点： fj.jtyz 福建厦门节点： xm.fj.jtyz 江西： jx.jtyz 江西上饶：sr.jx.jtyz 这就是数据库域名。 数据库域名在存在于参数文件中，他的参数是db_domain.</p>
<p>查询数据库域名 方法一：<code>select value from v$parameter where name = &#39;db_domain&#39;</code>; 方法二：<code>show parameter domain</code> 方法三：在参数文件中查询。</p>
<p>全局数据库名 全局数据库名&#x3D;数据库名+数据库域名，如前述福建节点的全局数据库名是：oradb.fj.jtyz</p>
<h3 id="数据库服务名"><a href="#数据库服务名" class="headerlink" title="数据库服务名"></a>数据库服务名</h3><p>什么是数据库服务名？ 从oracle9i版本开始，引入了一个新的参数，即数据库服务名。参数名是SERVICE_NAME。 如果数据库有域名，则数据库服务名就是全局数据库名；否则，数据库服务名与数据库名相同。</p>
<p>查询数据库服务名 方法一：select value from v$parameter where name &#x3D; ‘service_name’; 方法二：show parameter service_name 方法三：在参数文件中查询。</p>
<p>数据库服务名与网络连接 从oracle8i开如的oracle网络组件，数据库与客户端的连接主机串使用数据库服务名。之前用的是ORACLE_SID,即数据库实例名</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-12-26T07:23:55.000Z" title="12/26/2018, 3:23:55 PM">2018-12-26</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:16.119Z" title="2/9/2021, 11:03:16 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">20 分钟读完 (大约2941个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/12/26/37c3f433edda.html">MySQL中插入emoji表情报错的问题解决方案</a></p><div class="content"><p>操作：在内容中输入表情，然后点击查询，报错。<br><img src="/images/pics/85aae8d960eb7ad89b918fb65d0db752.png" alt="在这里插入图片描述"><br>其中这个请求的处理代码如下：<br><img src="/images/pics/c3a2db0713e62332d51e45e421e880b1.png" alt="在这里插入图片描述"><br>请求的内容为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/feedbacks?page=1&amp;size=20&amp;content=%F0%9F%98%AF%F0%9F%98%A2</span><br></pre></td></tr></table></figure>
<p>日志如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br></pre></td><td class="code"><pre><span class="line">2018-12-21 10:11:49,731 [http-nio-8889-exec-10]  INFO c.h.d.a.SystemAdvice - execute method : getFeedbacks</span><br><span class="line">2018-12-21 10:11:49,733 [http-nio-8889-exec-10] ERROR c.h.d.a.SystemAdvice - aspect execute error :</span><br><span class="line">org.springframework.jdbc.UncategorizedSQLException:</span><br><span class="line">### Error querying database.  Cause: java.sql.SQLException: Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation &#x27;like&#x27;</span><br><span class="line">### The error may exist in class path resource [mappers/BizFeedbackMapper.xml]</span><br><span class="line">### The error may involve defaultParameterMap</span><br><span class="line">### The error occurred while setting parameters</span><br><span class="line">### SQL: SELECT count(0) FROM biz_feedback WHERE content LIKE ? AND deleted = ?</span><br><span class="line">### Cause: java.sql.SQLException: Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation &#x27;like&#x27;</span><br><span class="line">; uncategorized SQLException; SQL state [HY000]; error code [1267]; Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation</span><br><span class="line"> &#x27;like&#x27;; nested exception is java.sql.SQLException: Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation &#x27;like&#x27;</span><br><span class="line">        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:89)</span><br><span class="line">        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)</span><br><span class="line">        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)</span><br><span class="line">        at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:73)</span><br><span class="line">        at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)</span><br><span class="line">        at com.sun.proxy.$Proxy77.selectList(Unknown Source)</span><br><span class="line">        at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)</span><br><span class="line">        at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:137)</span><br><span class="line">        at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:75)</span><br><span class="line">        at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:59)</span><br><span class="line">        at com.sun.proxy.$Proxy101.getSortedResultByConditionList(Unknown Source)</span><br><span class="line">        at com.haylion.dynamicbus.service.FeedbackService.getFeedbacks(FeedbackService.java:40)</span><br><span class="line">        at com.haylion.dynamicbus.service.FeedbackService$$FastClassBySpringCGLIB$$298f5809.invoke(&lt;generated&gt;)</span><br><span class="line">        at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)</span><br><span class="line">        at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)</span><br><span class="line">        at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)</span><br><span class="line">        at com.haylion.dynamicbus.advice.SystemAdvice.doAroundAdvice(SystemAdvice.java:44)</span><br><span class="line">        at sun.reflect.GeneratedMethodAccessor348.invoke(Unknown Source)</span><br><span class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">        at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">        at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)</span><br><span class="line">        at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)</span><br><span class="line">        at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)</span><br><span class="line">        at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)</span><br><span class="line">        at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)</span><br><span class="line">        at com.haylion.dynamicbus.service.FeedbackService$$EnhancerBySpringCGLIB$$ab8db9b2.getFeedbacks(&lt;generated&gt;)</span><br><span class="line">        at com.haylion.dynamicbus.controller.FeedbackController.getFeedbacks(FeedbackController.java:69)</span><br><span class="line">        at com.haylion.dynamicbus.controller.FeedbackController$$FastClassBySpringCGLIB$$825dd925.invoke(&lt;generated&gt;)</span><br><span class="line">        at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)</span><br><span class="line">        at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)</span><br><span class="line">        at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:119)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)</span><br><span class="line">        at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)</span><br><span class="line">        at com.haylion.dynamicbus.controller.FeedbackController$$EnhancerBySpringCGLIB$$f311ce89.getFeedbacks(&lt;generated&gt;)</span><br><span class="line">        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span><br><span class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">        at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">        at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:215)</span><br><span class="line">        at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:142)</span><br><span class="line">        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102)</span><br><span class="line">        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)</span><br><span class="line">        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)</span><br><span class="line">        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)</span><br><span class="line">        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)</span><br><span class="line">        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)</span><br><span class="line">        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:998)</span><br><span class="line">        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:890)</span><br><span class="line">        at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)</span><br><span class="line">        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:875)</span><br><span class="line">        at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at com.haylion.dynamicbus.facade.filter.TraceCopyFilter.doFilter(TraceCopyFilter.java:30)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)</span><br><span class="line">        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92)</span><br><span class="line">        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93)</span><br><span class="line">        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)</span><br><span class="line">        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)</span><br><span class="line">        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)</span><br><span class="line">        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)</span><br><span class="line">        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)</span><br><span class="line">        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)</span><br><span class="line">        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)</span><br><span class="line">        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)</span><br><span class="line">        at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)</span><br><span class="line">        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)</span><br><span class="line">        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:770)</span><br><span class="line">        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1415)</span><br><span class="line">        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)</span><br><span class="line">        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:748)</span><br><span class="line">Caused by: java.sql.SQLException: Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation &#x27;like&#x27;</span><br><span class="line">        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:964)</span><br><span class="line">        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)</span><br><span class="line">        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)</span><br><span class="line">        at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)</span><br><span class="line">        at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)</span><br><span class="line">        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2487)</span><br><span class="line">        at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)</span><br><span class="line">        at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)</span><br><span class="line">        at com.alibaba.druid.pool.DruidPooledPreparedStatement.execute(DruidPooledPreparedStatement.java:498)</span><br><span class="line">        at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:63)</span><br><span class="line">        at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:79)</span><br><span class="line">        at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:63)</span><br><span class="line">        at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:324)</span><br><span class="line">        at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)</span><br><span class="line">        at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)</span><br><span class="line">        at com.haylion.dynamicbus.interceptor.sql.MyPageInterceptor.executeAutoCount(MyPageInterceptor.java:211)</span><br><span class="line">        at com.haylion.dynamicbus.interceptor.sql.MyPageInterceptor.intercept(MyPageInterceptor.java:114)</span><br><span class="line">        at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:61)</span><br><span class="line">        at com.sun.proxy.$Proxy154.query(Unknown Source)</span><br><span class="line">        at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)</span><br><span class="line">        at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)</span><br><span class="line">        at sun.reflect.GeneratedMethodAccessor116.invoke(Unknown Source)</span><br><span class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">        at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">        at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)</span><br><span class="line">        ... 90 common frames omitted</span><br><span class="line">2018-12-21 10:11:49,734 [http-nio-8889-exec-10] ERROR c.h.d.f.e.ExceptionHandle - Exception for handle</span><br><span class="line">org.springframework.jdbc.UncategorizedSQLException:</span><br><span class="line">### Error querying database.  Cause: java.sql.SQLException: Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation &#x27;like&#x27;</span><br><span class="line">### The error may exist in class path resource [mappers/BizFeedbackMapper.xml]</span><br><span class="line">### The error may involve defaultParameterMap</span><br><span class="line">### The error occurred while setting parameters</span><br><span class="line">### SQL: SELECT count(0) FROM biz_feedback WHERE content LIKE ? AND deleted = ?</span><br><span class="line">### Cause: java.sql.SQLException: Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation &#x27;like&#x27;</span><br><span class="line">; uncategorized SQLException; SQL state [HY000]; error code [1267]; Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation</span><br><span class="line"> &#x27;like&#x27;; nested exception is java.sql.SQLException: Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation &#x27;like&#x27;</span><br><span class="line">        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:89)</span><br><span class="line">        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)</span><br><span class="line">        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)</span><br><span class="line">        at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:73)</span><br><span class="line">        at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)</span><br><span class="line">        at com.sun.proxy.$Proxy77.selectList(Unknown Source)</span><br><span class="line">        at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)</span><br><span class="line">        at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:137)</span><br><span class="line">        at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:75)</span><br><span class="line">        at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:59)</span><br><span class="line">        at com.sun.proxy.$Proxy101.getSortedResultByConditionList(Unknown Source)</span><br><span class="line">        at com.haylion.dynamicbus.service.FeedbackService.getFeedbacks(FeedbackService.java:40)</span><br><span class="line">        at com.haylion.dynamicbus.service.FeedbackService$$FastClassBySpringCGLIB$$298f5809.invoke(&lt;generated&gt;)</span><br><span class="line">        at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)</span><br><span class="line">        at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)</span><br><span class="line">        at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)</span><br><span class="line">        at com.haylion.dynamicbus.advice.SystemAdvice.doAroundAdvice(SystemAdvice.java:44)</span><br><span class="line">        at sun.reflect.GeneratedMethodAccessor348.invoke(Unknown Source)</span><br><span class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">        at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">        at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)</span><br><span class="line">        at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)</span><br><span class="line">        at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)</span><br><span class="line">        at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)</span><br><span class="line">        at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)</span><br><span class="line">        at com.haylion.dynamicbus.service.FeedbackService$$EnhancerBySpringCGLIB$$ab8db9b2.getFeedbacks(&lt;generated&gt;)</span><br><span class="line">        at com.haylion.dynamicbus.controller.FeedbackController.getFeedbacks(FeedbackController.java:69)</span><br><span class="line">        at com.haylion.dynamicbus.controller.FeedbackController$$FastClassBySpringCGLIB$$825dd925.invoke(&lt;generated&gt;)</span><br><span class="line">        at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)</span><br><span class="line">        at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:746)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)</span><br><span class="line">        at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:119)</span><br><span class="line">        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)</span><br><span class="line">        at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)</span><br><span class="line">        at com.haylion.dynamicbus.controller.FeedbackController$$EnhancerBySpringCGLIB$$f311ce89.getFeedbacks(&lt;generated&gt;)</span><br><span class="line">        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span><br><span class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">        at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">        at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:215)</span><br><span class="line">        at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:142)</span><br><span class="line">        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102)</span><br><span class="line">        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)</span><br><span class="line">        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)</span><br><span class="line">        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)</span><br><span class="line">        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)</span><br><span class="line">        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)</span><br><span class="line">        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:998)</span><br><span class="line">        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:890)</span><br><span class="line">        at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)</span><br><span class="line">        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:875)</span><br><span class="line">        at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at com.haylion.dynamicbus.facade.filter.TraceCopyFilter.doFilter(TraceCopyFilter.java:30)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)</span><br><span class="line">        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92)</span><br><span class="line">        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93)</span><br><span class="line">        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)</span><br><span class="line">        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)</span><br><span class="line">        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)</span><br><span class="line">        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)</span><br><span class="line">        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)</span><br><span class="line">        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)</span><br><span class="line">        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)</span><br><span class="line">        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)</span><br><span class="line">        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)</span><br><span class="line">        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)</span><br><span class="line">        at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)</span><br><span class="line">        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)</span><br><span class="line">        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:770)</span><br><span class="line">        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1415)</span><br><span class="line">        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span><br><span class="line">        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)</span><br><span class="line">        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)</span><br><span class="line">        at java.lang.Thread.run(Thread.java:748)</span><br><span class="line">Caused by: java.sql.SQLException: Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation &#x27;like&#x27;</span><br><span class="line">        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:964)</span><br><span class="line">        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)</span><br><span class="line">        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)</span><br><span class="line">        at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)</span><br><span class="line">        at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)</span><br><span class="line">        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2487)</span><br><span class="line">        at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)</span><br><span class="line">        at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)</span><br><span class="line">        at com.alibaba.druid.pool.DruidPooledPreparedStatement.execute(DruidPooledPreparedStatement.java:498)</span><br><span class="line">        at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:63)</span><br><span class="line">        at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:79)</span><br><span class="line">        at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:63)</span><br><span class="line">        at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:324)</span><br><span class="line">        at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)</span><br><span class="line">        at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)</span><br><span class="line">        at com.haylion.dynamicbus.interceptor.sql.MyPageInterceptor.executeAutoCount(MyPageInterceptor.java:211)</span><br><span class="line">        at com.haylion.dynamicbus.interceptor.sql.MyPageInterceptor.intercept(MyPageInterceptor.java:114)</span><br><span class="line">        at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:61)</span><br><span class="line">        at com.sun.proxy.$Proxy154.query(Unknown Source)</span><br><span class="line">        at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)</span><br><span class="line">        at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)</span><br><span class="line">        at sun.reflect.GeneratedMethodAccessor116.invoke(Unknown Source)</span><br><span class="line">        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">        at java.lang.reflect.Method.invoke(Method.java:498)</span><br><span class="line">        at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)</span><br><span class="line">        ... 90 common frames omitted</span><br><span class="line">2018-12-21 10:11:49,734 [http-nio-8889-exec-10]  INFO c.h.d.f.a.ResponseAdvice - Trace log is ====&gt;  &#123;&quot;url&quot;:&quot;/bus/feedbacks&quot;,&quot;httpMethod&quot;:&quot;GET&quot;,&quot;reqHeader&quot;:&#123;&quot;x-real-ip&quot;:</span><br><span class="line">&quot;10.10.0.195&quot;,&quot;referer&quot;:&quot;https://xxxxxxx.cn/&quot;,&quot;accept-language&quot;:&quot;zh,en;q=0.9,ja;q=0.8,zh-TW;q=0.7,fr;q=0.6&quot;,&quot;host&quot;:&quot;10.10.0.103&quot;,&quot;connection&quot;:&quot;close&quot;,&quot;x-forwar</span><br><span class="line">ded-for&quot;:&quot;10.10.0.195&quot;,&quot;userid&quot;:&quot;435&quot;,&quot;accept-encoding&quot;:&quot;gzip, deflate, br&quot;,&quot;accept&quot;:&quot;application/json, text/plain, */*&quot;,&quot;user-agent&quot;:&quot;Mozilla/5.0 (Windows NT 10.0; Win6</span><br><span class="line">4; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&quot;,&quot;token&quot;:&quot;67f7df9448dd691c71f57bcb95891bcf&quot;&#125;,&quot;reqParams&quot;:&quot;page=1&amp;size=20&amp;content=%F0%9F%</span><br><span class="line">98%AF%F0%9F%98%A2&quot;,&quot;requestBody&quot;:&quot;&quot;,&quot;respParams&quot;:&quot;&#123;\&quot;code\&quot;:500,\&quot;message\&quot;:\&quot;system is busy\&quot;,\&quot;data\&quot;:&#123;&#125;&#125;&quot;,&quot;startTime&quot;:1545358309731,&quot;spendTime&quot;:3&#125;</span><br></pre></td></tr></table></figure>
<p>从网上搜了一个解决方案，生效了：<br><img src="/images/pics/5561f6f1b6e7c0aa45eeae097c693137.png" alt="在这里插入图片描述"><br>然后重启MySQL，<code>service mysql restart</code><br>链接地址为：<a target="_blank" rel="noopener" href="https://dba.stackexchange.com/questions/89355/unable-to-insert-utf8mb4-characters-in-mysql-5-6">https://dba.stackexchange.com/questions/89355/unable-to-insert-utf8mb4-characters-in-mysql-5-6</a></p>
<p><img src="/images/pics/98fe988ee7eb6e37a0885822fc22ca3e.png" alt="在这里插入图片描述"><br>以下关于MySQL中的字符相关的知识来自链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chyingp/p/mysql-character-set-collation.html">https://www.cnblogs.com/chyingp/p/mysql-character-set-collation.html</a></p>
<p>通过分析，得出一下结论：<br>like里面填写的数据的编码格式为utf8，为character_set_server的值，而表里面的编码为utf8mb4，所以他们的值的字符序列是不一样的，因此造成了上述问题的出现。所以解决的办法是将服务器的字符改成utf8mb4，这样like的值就是utf8mb4编码格式，字符序就与表中的字段一致，问题解决。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-11-14T19:45:18.000Z" title="11/15/2018, 3:45:18 AM">2018-11-15</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:43.877Z" title="2/9/2021, 11:03:43 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">8 分钟读完 (大约1162个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/11/15/f3827fe969b1.html">MongoDB原生脚本的CURD--官方文档阅读笔记</a></p><div class="content"><h2 id="安装-登录"><a href="#安装-登录" class="headerlink" title="安装&amp;登录"></a>安装&amp;登录</h2><p>0、Windows下使用从<a target="_blank" rel="noopener" href="https://www.mongodb.com/">MongoDB官网</a>下载MSI安装文件，感觉比zip的安装包使用便捷。Ubuntu Linux下使用<code>sudo apt install mongodb-server</code>安装、其配置文件路径为<code>/etc/mongodb.conf</code>、可以通过在其中配置数据库路径。<br><img src="/images/pics/ce92d9970d686a9a91326632ccfae6df.png" alt="在这里插入图片描述"><br>Mac下使用<code>brew install mongodb</code>，其配置信息可参考如下：<br><img src="/images/pics/3239f24dbbbe5ccb30a022e9a34217bc.png" alt="在这里插入图片描述"><br>1、<code>mongod --bind_all</code>  默认只能本机访问MongoDB、使用此选项可以让别的机器通过网络访问<br>2、如果不能访问，检查端口是否开放，默认为27017。AWS的EC2需要在入站规则中加入该端口才会生效。<br>3、使用<code>mongo</code>进入数据库后、创建用户与密码。</p>
<h2 id="Mongo-Shell"><a href="#Mongo-Shell" class="headerlink" title="Mongo Shell"></a>Mongo Shell</h2><h3 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="property">collection</span>.<span class="title function_">insert</span>(</span><br><span class="line">   &lt;document or array of documents&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">     writeConcern: &lt;document&gt;, // </span><br><span class="line">     ordered: &lt;boolean&gt; // 按顺序插入</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br><span class="line">db.inventory.insertOne(</span><br><span class="line">   &#123; item: &quot;canvas&quot;, qty: 100, tags: [&quot;cotton&quot;], size: &#123; h: 28, w: 35.5, uom: &quot;cm&quot; &#125; &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="save"><a href="#save" class="headerlink" title="save"></a>save</h3><p>Updates an existing document or inserts a new document, depending on its document parameter.</p>
<h3 id="query"><a href="#query" class="headerlink" title="query"></a>query</h3><p><strong>一般查询：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123;&#125; )</span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="attr">status</span>: <span class="string">&quot;D&quot;</span> &#125; )</span><br></pre></td></tr></table></figure>
<p><strong>使用查询操作符查询：</strong><br>更多查询操作符：<a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/operator/query/">https://docs.mongodb.com/manual/reference/operator/query/</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 格式：&#123; &lt;field1&gt;: &#123; &lt;operator1&gt;: &lt;value1&gt; &#125;, ... &#125;</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="attr">status</span>: &#123; <span class="attr">$in</span>: [ <span class="string">&quot;A&quot;</span>, <span class="string">&quot;D&quot;</span> ] &#125; &#125; )</span><br></pre></td></tr></table></figure>
<p><strong>使用AND</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// status==‘A’ &amp;&amp; qty &lt; 30</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">qty</span>: &#123; <span class="attr">$lt</span>: <span class="number">30</span> &#125; &#125; )</span><br></pre></td></tr></table></figure>
<p><strong>使用OR</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// status==‘A’ || qty &lt; 30</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="attr">$or</span>: [ &#123; <span class="attr">status</span>: <span class="string">&quot;A&quot;</span> &#125;, &#123; <span class="attr">qty</span>: &#123; <span class="attr">$lt</span>: <span class="number">30</span> &#125; &#125; ] &#125; )</span><br><span class="line"></span><br><span class="line"><span class="comment">// status==&#x27;A&#x27; &amp;&amp; (qty &lt; 30 || item like &#x27;p%&#x27;)</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123;</span><br><span class="line">     <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">     <span class="attr">$or</span>: [ &#123; <span class="attr">qty</span>: &#123; <span class="attr">$lt</span>: <span class="number">30</span> &#125; &#125;, &#123; <span class="attr">item</span>: <span class="regexp">/^p/</span> &#125; ]</span><br><span class="line">&#125; )</span><br></pre></td></tr></table></figure>
<p><strong>正则表达式</strong><br>详细可参考：<a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/operator/query/regex/">https://docs.mongodb.com/manual/reference/operator/query/regex/</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 格式：</span></span><br><span class="line"><span class="comment">&#123; &lt;field&gt;: &#123; $regex: /pattern/, $options: &#x27;&lt;options&gt;&#x27; &#125; &#125;</span></span><br><span class="line"><span class="comment">&#123; &lt;field&gt;: &#123; $regex: &#x27;pattern&#x27;, $options: &#x27;&lt;options&gt;&#x27; &#125; &#125;</span></span><br><span class="line"><span class="comment">&#123; &lt;field&gt;: &#123; $regex: /pattern/&lt;options&gt; &#125; &#125;</span></span><br><span class="line"><span class="comment">-----</span></span><br><span class="line"><span class="comment">&#123; &lt;field&gt;: /pattern/&lt;options&gt; &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">----------------------------------------------------------</span><br><span class="line"><span class="comment">// 查询title以h开头的文档，options里面有i说明大小写不敏感</span></span><br><span class="line">db.<span class="property">bizQuestion</span>.<span class="title function_">find</span>( &#123;</span><br><span class="line">	title : &#123;$regex : <span class="regexp">/^h/</span>, <span class="attr">$options</span>:<span class="string">&#x27;i&#x27;</span>&#125;</span><br><span class="line">&#125; )</span><br></pre></td></tr></table></figure>
<p>两种格式的使用场景存在差异，具体可参考上述链接：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">name</span>: &#123; <span class="attr">$in</span>: [ <span class="regexp">/^acme/i</span>, <span class="regexp">/^ack/</span> ] &#125; &#125; <span class="comment">// 这里只能使用第二种格式</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/pics/bd9b7d0d62bf0fe45c315f95bcc4956c.png" alt="在这里插入图片描述"><br><strong>如果文档中的某个字段的值是文档</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插入--注意size的结构</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">insertMany</span>( [</span><br><span class="line">   &#123; <span class="attr">item</span>: <span class="string">&quot;journal&quot;</span>, <span class="attr">qty</span>: <span class="number">25</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">14</span>, <span class="attr">w</span>: <span class="number">21</span>, <span class="attr">uom</span>: <span class="string">&quot;cm&quot;</span> &#125;, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span> &#125;,</span><br><span class="line">   &#123; <span class="attr">item</span>: <span class="string">&quot;notebook&quot;</span>, <span class="attr">qty</span>: <span class="number">50</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">8.5</span>, <span class="attr">w</span>: <span class="number">11</span>, <span class="attr">uom</span>: <span class="string">&quot;in&quot;</span> &#125;, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span> &#125;,</span><br><span class="line">   &#123; <span class="attr">item</span>: <span class="string">&quot;paper&quot;</span>, <span class="attr">qty</span>: <span class="number">100</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">8.5</span>, <span class="attr">w</span>: <span class="number">11</span>, <span class="attr">uom</span>: <span class="string">&quot;in&quot;</span> &#125;, <span class="attr">status</span>: <span class="string">&quot;D&quot;</span> &#125;,</span><br><span class="line">   &#123; <span class="attr">item</span>: <span class="string">&quot;planner&quot;</span>, <span class="attr">qty</span>: <span class="number">75</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">22.85</span>, <span class="attr">w</span>: <span class="number">30</span>, <span class="attr">uom</span>: <span class="string">&quot;cm&quot;</span> &#125;, <span class="attr">status</span>: <span class="string">&quot;D&quot;</span> &#125;,</span><br><span class="line">   &#123; <span class="attr">item</span>: <span class="string">&quot;postcard&quot;</span>, <span class="attr">qty</span>: <span class="number">45</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">10</span>, <span class="attr">w</span>: <span class="number">15.25</span>, <span class="attr">uom</span>: <span class="string">&quot;cm&quot;</span> &#125;, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span> &#125;</span><br><span class="line">]);</span><br><span class="line"><span class="comment">// 接着上面的进行查询。</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">14</span>, <span class="attr">w</span>: <span class="number">21</span>, <span class="attr">uom</span>: <span class="string">&quot;cm&quot;</span> &#125; &#125; )   <span class="comment">// OK</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="attr">size</span>: &#123; <span class="attr">w</span>: <span class="number">21</span>, <span class="attr">h</span>: <span class="number">14</span>, <span class="attr">uom</span>: <span class="string">&quot;cm&quot;</span> &#125; &#125; )   <span class="comment">// X, 注意顺序，这里匹配不到任何东西</span></span><br></pre></td></tr></table></figure>
<p>执行效果如下：<br><img src="/images/pics/cd7d054d1fccd1c92f71b89c33cda78f.png" alt="在这里插入图片描述"><br>如果只以size中的某一个字段为查询域</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="string">&quot;size.uom&quot;</span>: <span class="string">&quot;in&quot;</span> &#125; )</span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="string">&quot;size.h&quot;</span>: &#123; <span class="attr">$lt</span>: <span class="number">15</span> &#125; &#125; )</span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="string">&quot;size.h&quot;</span>: &#123; <span class="attr">$lt</span>: <span class="number">15</span> &#125;, <span class="string">&quot;size.uom&quot;</span>: <span class="string">&quot;in&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;D&quot;</span> &#125; )</span><br></pre></td></tr></table></figure>
<p><strong>其中的字段还可以为一个数组，数组中的数据可以是一个简单的类型，如整数、字符串等，也可以还是一个文档。对于这些情况，其查询方式存在或多或少的差异，可以在需要的时候参考官方文档。</strong></p>
<h3 id="如何返回自己想要的字段"><a href="#如何返回自己想要的字段" class="headerlink" title="如何返回自己想要的字段"></a>如何返回自己想要的字段</h3><p>前面查询得到的结果都是全部的字段，如果不需要返回所有的字段，可以通过设置projection来达到目的，projection的解释：</p>
<blockquote>
<p>A document given to a query that specifies which fields MongoDB returns in the result set.</p>
</blockquote>
<p><strong>其中还包括字段为数组以及数组中的字段为文档的多种情况。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始数据结构</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">insertMany</span>( [</span><br><span class="line">  &#123; <span class="attr">item</span>: <span class="string">&quot;journal&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">14</span>, <span class="attr">w</span>: <span class="number">21</span>, <span class="attr">uom</span>: <span class="string">&quot;cm&quot;</span> &#125;, <span class="attr">instock</span>: [ &#123; <span class="attr">warehouse</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">qty</span>: <span class="number">5</span> &#125; ] &#125;,</span><br><span class="line">  &#123; <span class="attr">item</span>: <span class="string">&quot;notebook&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>,  <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">8.5</span>, <span class="attr">w</span>: <span class="number">11</span>, <span class="attr">uom</span>: <span class="string">&quot;in&quot;</span> &#125;, <span class="attr">instock</span>: [ &#123; <span class="attr">warehouse</span>: <span class="string">&quot;C&quot;</span>, <span class="attr">qty</span>: <span class="number">5</span> &#125; ] &#125;,</span><br><span class="line">  &#123; <span class="attr">item</span>: <span class="string">&quot;paper&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;D&quot;</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">8.5</span>, <span class="attr">w</span>: <span class="number">11</span>, <span class="attr">uom</span>: <span class="string">&quot;in&quot;</span> &#125;, <span class="attr">instock</span>: [ &#123; <span class="attr">warehouse</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">qty</span>: <span class="number">60</span> &#125; ] &#125;,</span><br><span class="line">  &#123; <span class="attr">item</span>: <span class="string">&quot;planner&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;D&quot;</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">22.85</span>, <span class="attr">w</span>: <span class="number">30</span>, <span class="attr">uom</span>: <span class="string">&quot;cm&quot;</span> &#125;, <span class="attr">instock</span>: [ &#123; <span class="attr">warehouse</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">qty</span>: <span class="number">40</span> &#125; ] &#125;,</span><br><span class="line">  &#123; <span class="attr">item</span>: <span class="string">&quot;postcard&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">size</span>: &#123; <span class="attr">h</span>: <span class="number">10</span>, <span class="attr">w</span>: <span class="number">15.25</span>, <span class="attr">uom</span>: <span class="string">&quot;cm&quot;</span> &#125;, <span class="attr">instock</span>: [ &#123; <span class="attr">warehouse</span>: <span class="string">&quot;B&quot;</span>, <span class="attr">qty</span>: <span class="number">15</span> &#125;, &#123; <span class="attr">warehouse</span>: <span class="string">&quot;C&quot;</span>, <span class="attr">qty</span>: <span class="number">35</span> &#125; ] &#125;</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回结果显示item,status，不显示_id</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="attr">status</span>: <span class="string">&quot;A&quot;</span> &#125;, &#123; <span class="attr">item</span>: <span class="number">1</span>, <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">_id</span>: <span class="number">0</span> &#125; )</span><br><span class="line"><span class="comment">// 如果字段的值也是一个文档</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>(</span><br><span class="line">   &#123; <span class="attr">status</span>: <span class="string">&quot;A&quot;</span> &#125;,</span><br><span class="line">   &#123; <span class="attr">item</span>: <span class="number">1</span>, <span class="attr">status</span>: <span class="number">1</span>, <span class="string">&quot;size.uom&quot;</span>: <span class="number">1</span> &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// 字段为数组，数组的类型是文档</span></span><br><span class="line">db.<span class="property">inventory</span>.<span class="title function_">find</span>( &#123; <span class="attr">status</span>: <span class="string">&quot;A&quot;</span> &#125;, &#123; <span class="attr">item</span>: <span class="number">1</span>, <span class="attr">status</span>: <span class="number">1</span>, <span class="string">&quot;instock.qty&quot;</span>: <span class="number">1</span> &#125; )</span><br></pre></td></tr></table></figure>


<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="property">books</span>.<span class="title function_">update</span>(</span><br><span class="line">  &#123; <span class="attr">_id</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">$inc</span>: &#123; <span class="attr">stock</span>: <span class="number">5</span> &#125;,</span><br><span class="line">    <span class="attr">$set</span>: &#123;</span><br><span class="line">      <span class="attr">item</span>: <span class="string">&quot;ABC123&quot;</span>,</span><br><span class="line">      <span class="string">&quot;info.publisher&quot;</span>: <span class="string">&quot;2222&quot;</span>,</span><br><span class="line">      <span class="attr">tags</span>: [ <span class="string">&quot;software&quot;</span> ],</span><br><span class="line">      <span class="string">&quot;ratings.1&quot;</span>: &#123; <span class="attr">by</span>: <span class="string">&quot;xyz&quot;</span>, <span class="attr">rating</span>: <span class="number">3</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  db.<span class="property">restaurant</span>.<span class="title function_">updateMany</span>(</span><br><span class="line">    &#123; <span class="attr">violations</span>: &#123; <span class="attr">$gt</span>: <span class="number">4</span> &#125; &#125;,</span><br><span class="line">    &#123; <span class="attr">$set</span>: &#123; <span class="string">&quot;Review&quot;</span> : <span class="literal">true</span> &#125; &#125;</span><br><span class="line">  );</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="title function_">print</span>(e);</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"><span class="comment">// The following operation updates a single document where name: &quot;Central Perk Cafe&quot; with the violations field:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  db.<span class="property">restaurant</span>.<span class="title function_">updateOne</span>(</span><br><span class="line">    &#123; <span class="string">&quot;name&quot;</span> : <span class="string">&quot;Central Perk Cafe&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">$set</span>: &#123; <span class="string">&quot;violations&quot;</span> : <span class="number">3</span> &#125; &#125;</span><br><span class="line">  );</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="title function_">print</span>(e);</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"><span class="comment">// The following operation attempts to update the document with name : &quot;Pizza Rat&#x27;s Pizzaria&quot;, while upsert: true :</span></span><br><span class="line"><span class="comment">// 对于这个upsert：true这个参数，update--insert。如果为true并且前面的query没有匹配到，则会进行插入，否则更新。</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  db.<span class="property">restaurant</span>.<span class="title function_">updateOne</span>(</span><br><span class="line">    &#123; <span class="string">&quot;name&quot;</span> : <span class="string">&quot;Pizza Rat&#x27;s Pizzaria&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">$set</span>: &#123;<span class="string">&quot;_id&quot;</span> : <span class="number">4</span>, <span class="string">&quot;violations&quot;</span> : <span class="number">7</span>, <span class="string">&quot;borough&quot;</span> : <span class="string">&quot;Manhattan&quot;</span> &#125; &#125;,</span><br><span class="line">    &#123; <span class="attr">upsert</span>: <span class="literal">true</span> &#125;</span><br><span class="line">  );</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="title function_">print</span>(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-04T01:43:07.000Z" title="9/4/2018, 9:43:07 AM">2018-09-04</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:01.790Z" title="2/9/2021, 11:03:01 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><span> / </span><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">5 分钟读完 (大约794个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/09/04/5d21a06dc6b4.html">CentOS7中安装MySQL的详细过程以及配置</a></p><div class="content"><p>首先使用yum安装mariadb，它是MySQL的一个分支。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum install -y mariadb-server <span class="comment"># 安装mariadb</span></span><br><span class="line">rpm -qa | grep mariadb <span class="comment"># 查看mariadb已安装的相关包</span></span><br></pre></td></tr></table></figure>
<p>要连上数据库，就得先启动它。所以先尝试下面的启动命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mariadb.service <span class="comment">#启动服务</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb.service <span class="comment">#设置开机启动</span></span><br><span class="line">systemctl restart mariadb.service <span class="comment">#重新启动</span></span><br><span class="line">systemctl stop mariadb.service <span class="comment">#停止MariaDB</span></span><br></pre></td></tr></table></figure>
<p>启动后，在命令行中输入<code>mysql -u root -p</code>，<strong>root密码默认为空</strong>，直接按回车即可。此时的密码为空，先设置一个密码，方法有多种，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1.用root 进入mysql后</span><br><span class="line">mysql&gt;set password =password(&#x27;你的密码&#x27;);</span><br><span class="line"># 或者</span><br><span class="line">mysql&gt;set password for root@localhost = password(&#x27;hellomysql&#x27;);</span><br><span class="line">mysql&gt;flush privileges;</span><br><span class="line"></span><br><span class="line">2.使用GRANT语句 </span><br><span class="line">mysql&gt;grant all on *.* to &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;你的密码&#x27;with grant option ;</span><br><span class="line">mysql&gt;flush privileges;</span><br><span class="line"></span><br><span class="line">3.进入mysql库修改user表</span><br><span class="line">mysql&gt;use mysql;</span><br><span class="line">mysql&gt;update user set password=password(&#x27;你的密码&#x27;) where user=&#x27;root&#x27;; </span><br><span class="line">mysql&gt;flush privileges;</span><br></pre></td></tr></table></figure>

<p>如果要从局域网中访问数据库，那么需要紧接着进行下面的配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择mysql这个数据库</span></span><br><span class="line">use mysql;</span><br><span class="line"><span class="comment"># 这一句执行完可能会报错，不用管它。</span></span><br><span class="line">update user <span class="built_in">set</span> host = <span class="string">&#x27;%&#x27;</span> <span class="built_in">where</span> user = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="comment"># 刷新配置</span></span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<p>接下来配置防火墙，将3306端口开放：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> firewall-cmd --add-port=3306/tcp --permanent <span class="comment"># 开放3306端口</span></span><br><span class="line"><span class="built_in">sudo</span> firewall-cmd --reload <span class="comment"># 重新读入配置</span></span><br></pre></td></tr></table></figure>
<p>这个时候应该就可以通过局域网访问了。</p>
<p><strong>如果忘记了root密码怎么办？</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先，先关闭mysql原来的服务：</span></span><br><span class="line">systemctl stop mariadb.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启mysql的安全模式</span></span><br><span class="line"><span class="built_in">sudo</span> mysqld_safe --skip-grant-tables&amp;</span><br><span class="line"><span class="comment"># 进入mysql，直接修改表中root的密码</span></span><br><span class="line">mysql&gt;update user <span class="built_in">set</span> password=password(<span class="string">&quot;hellomysql&quot;</span>) <span class="built_in">where</span> user=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">mysql&gt;flush privileges; <span class="comment"># 刷新权限</span></span><br><span class="line">mysql&gt;<span class="built_in">exit</span>;</span><br><span class="line"><span class="comment"># 然后关闭mysql的安全模式。这里只需要将之前开启的mysql进程关闭掉即可。</span></span><br><span class="line">ps aux | grep mysqld <span class="comment"># 列出mysql的进程信息</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">kill</span> -s 9 xxxx <span class="comment"># 强制关闭进程</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新打开mysql服务</span></span><br><span class="line">systemctl start mariadb.service</span><br></pre></td></tr></table></figure>

<p><strong>关于MySQL中的用户与host</strong><br><img src="/images/pics/6b670fd6f353acdcfb1a388917fb3e97.png" alt="这里写图片描述"><br>仔细观察这个表，我们可以发现同一个root，可能对于不同的host。换个角度，也就是说，<strong>同一个用户的不同host，我们可以设置不同的权限以及密码</strong>。这是一个在解决了局域网中不能访问数据库这个问题后，本地访问数据库出现了不能访问的情况。不能用密码访问，但是可以无密码访问，无密码访问后，没有任何修改的权限。仔细看上表中的第5行，之前不是这样，上图是被我修改过之后，正常运行的截图。未修改之前，User那一栏是空的，Password也是空的，其它三项权限都是N，所以也不难理解为什么会出现上述的情况。后面手动修改成上面的数据后，变可以以“root+密码”进行访问，并且有相应的权限。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-07-30T22:29:09.000Z" title="7/31/2018, 6:29:09 AM">2018-07-31</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:49.112Z" title="2/9/2021, 11:03:49 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">9 分钟读完 (大约1340个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/07/31/5061116eb624.html">MySQL中的常用关键字</a></p><div class="content"><blockquote>
<p>很久不用MySQL，感觉又是一个新的玩意儿了，写起SQL语句来感觉好陌生，确实是很久了！</p>
</blockquote>
<h2 id="distinct"><a href="#distinct" class="headerlink" title="distinct"></a>distinct</h2><p>查询出某个字段不重复的记录。可用distinct来返回不重复字段的条数<code>count(distinct id)</code>。</p>
<h2 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h2><p>记得这个可以用来做分页。它后面可以接受一个或两个数字参数。参数必须是一个整数常量。如果给定两个参数，<strong>第一个参数指定第一个返回记录行的偏移量，第二个参数指定返回记录行的最大数目</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>初始记录行的偏移量是 <span class="number">0</span>(而不是 <span class="number">1</span>)：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span> LIMIT <span class="number">5</span>,<span class="number">10</span>; <span class="operator">/</span><span class="operator">/</span>检索记录行<span class="number">6</span><span class="number">-15</span></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>为了检索从某一个偏移量到记录集的结束所有的记录行，可以指定第二个参数为 <span class="number">-1</span>：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span> LIMIT <span class="number">95</span>,<span class="number">-1</span>; <span class="operator">/</span><span class="operator">/</span> 检索记录行 <span class="number">96</span><span class="operator">-</span><span class="keyword">last</span></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>如果只给定一个参数，它表示返回最大的记录行数目。换句话说，LIMIT n 等价于 LIMIT <span class="number">0</span>,n：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span> LIMIT <span class="number">5</span>;     <span class="operator">/</span><span class="operator">/</span>检索前 <span class="number">5</span> 个记录行</span><br></pre></td></tr></table></figure>
<h3 id="limit的效率高？"><a href="#limit的效率高？" class="headerlink" title="limit的效率高？"></a>limit的效率高？</h3><p>常说的Limit的执行效率高，是对于一种特定条件下来说的：即数据库的数量很大，但是只需要查询一部分数据的情况。高效率的原理是：避免全表扫描，提高查询效率。比如：每个用户的email是唯一的，如果用户使用email作为用户名登陆的话，就需要查询出email对应的一条记录。<br><code>SELECT * FROM t_user WHERE email=?;</code><br>上面的语句实现了查询email对应的一条用户信息，但是由于email这一列没有加索引，会导致全表扫描，效率会很低。<br><code>SELECT * FROM t_user WHERE email=? LIMIT 1;</code><br>加上LIMIT 1，只要找到了对应的一条记录，就不会继续向下扫描了，效率会大大提高。</p>
<h3 id="limit的效率低？"><a href="#limit的效率低？" class="headerlink" title="limit的效率低？"></a>limit的效率低？</h3><p>在一种情况下，使用limit效率低，那就是：只使用limit来查询语句，并且偏移量特别大的情况。做以下实验：<br><strong>语句1：</strong><br><code>select * from table limit 150000,1000;</code><br><strong>语句2:</strong><br><code>select * from table while id&gt;=150000 limit 1000;</code><br>语句1为0.2077秒；语句2为0.0063秒。两条语句的时间比是：语句1&#x2F;语句2＝32.968</p>
<p>比较以上的数据时，我们可以发现采用where…limit….性能基本稳定，受偏移量和行数的影响不大，而单纯采用limit的话，受偏移量的影响很大，当偏移量大到一定后性能开始大幅下降。不过在数据量不大的情况下，两者的区别不大。所以应当先使用where等查询语句，配合limit使用，效率才高。在sql语句中，limt关键字是最后才用到的。以下条件的出现顺序一般是：**<code>where-&gt;group by-&gt;having-order by-&gt;limit</code>**</p>
<h3 id="OFFSET"><a href="#OFFSET" class="headerlink" title="OFFSET"></a>OFFSET</h3><p>为了与 PostgreSQL 兼容，MySQL 也支持句法： LIMIT # OFFSET #。经常用到在数据库中查询中间几条数据的需求比如下面的sql语句：</p>
<p>① <code>selete * from testtable limit 2,1;</code><br>② <code>selete * from testtable limit 2 offset 1;</code></p>
<p>注意：<br>1.数据库数据计算是从0开始的<br>2.offset X是跳过X个数据，limit Y是选取Y个数据<br>3.limit  X,Y  中X表示跳过X个数据，读取Y个数据</p>
<p>这两个都是能完成需要，但是他们之间是有区别的：<br>①是从数据库中第三条开始查询，取一条数据，即第三条数据读取，一二条跳过<br>②是从数据库中的第二条数据开始查询两条数据，即第二条和第三条。</p>
<h2 id="UNION-UNION-ALL"><a href="#UNION-UNION-ALL" class="headerlink" title="UNION &amp; UNION ALL"></a>UNION &amp; UNION ALL</h2><p>union all是直接连接，取到得是所有值，记录可能有重复   union 是取唯一值，记录没有重复。</p>
<p>1、UNION 的语法如下：<br>     [SQL 语句 1]<br>      UNION<br>     [SQL 语句 2]</p>
<p>2、UNION ALL 的语法如下：<br>     [SQL 语句 1]<br>      UNION ALL<br>     [SQL 语句 2]</p>
<h3 id="效率"><a href="#效率" class="headerlink" title="效率"></a>效率</h3><p>UNION和UNION ALL关键字都是将两个结果集合并为一个，但这两者从使用和效率上来说都有所不同。</p>
<p>1、对重复结果的处理：UNION在进行表链接后会筛选掉重复的记录，Union All不会去除重复记录。</p>
<p>2、对排序的处理：Union将会按照字段的顺序进行排序；UNION ALL只是简单的将两个结果合并后就返回。</p>
<p>从效率上说，UNION ALL 要比UNION快很多，所以，如果可以确认合并的两个结果集中不包含重复数据且不需要排序时的话，那么就使用UNION ALL。</p>
<h3 id="简单应用"><a href="#简单应用" class="headerlink" title="简单应用"></a>简单应用</h3><p>将一个表的内容弄成两份到一个输出中：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> players) b</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">all</span></span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> players) ;</span><br></pre></td></tr></table></figure>
<h2 id="join相关"><a href="#join相关" class="headerlink" title="join相关"></a>join相关</h2><p>left join(左联接) 返回包括左表中的所有记录和右表中联结字段相等的记录<br>right join(右联接) 返回包括右表中的所有记录和左表中联结字段相等的记录<br>inner join(等值连接) 只返回两个表中联结字段相等的行</p>
<p>参考：<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/acm-bingzi/p/msqlLimit.html">https://www.cnblogs.com/acm-bingzi/p/msqlLimit.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-07-30T22:22:54.000Z" title="7/31/2018, 6:22:54 AM">2018-07-31</time>发表</span><span class="level-item"><time dateTime="2021-02-09T03:03:24.211Z" title="2/9/2021, 11:03:24 AM">2021-02-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="level-item">2 分钟读完 (大约358个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/07/31/b890da07a04b.html">MySQL中的日期操作</a></p><div class="content"><h2 id="获取当前时间"><a href="#获取当前时间" class="headerlink" title="获取当前时间"></a>获取当前时间</h2><ul>
<li><p><code>now()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select now();</span><br><span class="line">+---------------------+</span><br><span class="line">| now()               |</span><br><span class="line">+---------------------+</span><br><span class="line">| 2018-07-26 15:58:46 |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>sysdate()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select sysdate()</span><br><span class="line">+---------------------+</span><br><span class="line">| sysdate()           |</span><br><span class="line">+---------------------+</span><br><span class="line">| 2018-07-26 15:59:19 |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>两者之间的区别在于：**<code>sysdate()</code>是实时获取的**。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select now(), sleep(3), now();</span><br><span class="line">+---------------------+----------+---------------------+</span><br><span class="line">| now()               | sleep(3) | now()               |</span><br><span class="line">+---------------------+----------+---------------------+</span><br><span class="line">| 2018-07-26 16:00:14 |        0 | 2018-07-26 16:00:14 |</span><br><span class="line">+---------------------+----------+---------------------+</span><br><span class="line">1 row in set (3.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select sysdate(), sleep(3), sysdate();</span><br><span class="line">+---------------------+----------+---------------------+</span><br><span class="line">| sysdate()           | sleep(3) | sysdate()           |</span><br><span class="line">+---------------------+----------+---------------------+</span><br><span class="line">| 2018-07-26 16:00:30 |        0 | 2018-07-26 16:00:33 |</span><br><span class="line">+---------------------+----------+---------------------+</span><br><span class="line">1 row in set (3.00 sec)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>current_timestamp</code>, <code>current_timestamp()</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select current_timestamp, current_timestamp();</span><br><span class="line">+---------------------+---------------------+</span><br><span class="line">| current_timestamp   | current_timestamp() |</span><br><span class="line">+---------------------+---------------------+</span><br><span class="line">| 2018-07-26 16:04:01 | 2018-07-26 16:04:01 |</span><br><span class="line">+---------------------+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h2 id="日期、时间转换"><a href="#日期、时间转换" class="headerlink" title="日期、时间转换"></a>日期、时间转换</h2><p>感觉时间与日期这块有挺多操作的，包括与字符串的相互转换等。</p>
<h3 id="日期-时间转字符串"><a href="#日期-时间转字符串" class="headerlink" title="日期&#x2F;时间转字符串"></a>日期&#x2F;时间转字符串</h3><ul>
<li><code> date_format()</code>&#x2F;<code>time_format()</code>将日期&#x2F;时间转换成字符串<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select date_format(&#x27;2018-7-26 16:05:11&#x27;, &#x27;%Y%m%d%H%i%s&#x27;)</span><br><span class="line">+---------------------------------------------------+</span><br><span class="line">| date_format(&#x27;2018-7-26 16:05:11&#x27;, &#x27;%Y%m%d%H%i%s&#x27;) |</span><br><span class="line">+---------------------------------------------------+</span><br><span class="line">| 20180726160511                                    |</span><br><span class="line">+---------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select time_format(&#x27;16:05:11&#x27;, &#x27;%H%i%s&#x27;);</span><br><span class="line">+-----------------------------------+</span><br><span class="line">| time_format(&#x27;16:05:11&#x27;, &#x27;%H%i%s&#x27;) |</span><br><span class="line">+-----------------------------------+</span><br><span class="line">| 160511                            |</span><br><span class="line">+-----------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure></li>
<li><code>str_to_date()</code> 将字符串转成日期类型。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select str_to_date(&#x27;07/26/2018&#x27;, &#x27;%m/%d/%Y&#x27;);</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| str_to_date(&#x27;07/26/2018&#x27;, &#x27;%m/%d/%Y&#x27;) |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| 2018-07-26                            |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select str_to_date(&#x27;2018/7/26 16:23:33&#x27;,&#x27;%Y/%m/%d %H:%i:%s&#x27;);</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| str_to_date(&#x27;2018/7/26 16:23:33&#x27;,&#x27;%Y/%m/%d %H:%i:%s&#x27;) |</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| 2018-07-26 16:23:33                                   |</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="日期时间计算函数"><a href="#日期时间计算函数" class="headerlink" title="日期时间计算函数"></a>日期时间计算函数</h2><p><strong>为日期增加一个时间间隔：date_add()</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">set @dt = now();</span><br><span class="line"></span><br><span class="line">select date_add(@dt, interval 1 day); -- add 1 day</span><br><span class="line">select date_add(@dt, interval 1 hour); -- add 1 hour</span><br><span class="line">select date_add(@dt, interval 1 minute); -- ...</span><br><span class="line">select date_add(@dt, interval 1 second);</span><br><span class="line">select date_add(@dt, interval 1 microsecond);</span><br><span class="line">select date_add(@dt, interval 1 week);</span><br><span class="line">select date_add(@dt, interval 1 month);</span><br><span class="line">select date_add(@dt, interval 1 quarter);</span><br><span class="line">select date_add(@dt, interval 1 year);</span><br><span class="line"></span><br><span class="line">select date_add(@dt, interval -1 day); -- sub 1 day</span><br></pre></td></tr></table></figure>

<p><strong>为日期减去一个时间间隔：<code>date_sub()</code></strong><br><strong>日期、时间相减函数：<code>datediff(date1,date2)</code>, <code>timediff(time1,time2)</code></strong></p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/page/0/">上一页</a></div><div class="pagination-next"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/page/2/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">1</a></li><li><a class="pagination-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/12/"><span class="level-start"><span class="level-item">十二月 2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">二月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">一月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">一月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">四月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">十一月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">十月 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">七月 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">六月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">四月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">三月 2019</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/02/"><span class="level-start"><span class="level-item">二月 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/01/"><span class="level-start"><span class="level-item">一月 2019</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/12/"><span class="level-start"><span class="level-item">十二月 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">十一月 2018</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">九月 2018</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">八月 2018</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/07/"><span class="level-start"><span class="level-item">七月 2018</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/06/"><span class="level-start"><span class="level-item">六月 2018</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/05/"><span class="level-start"><span class="level-item">五月 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/04/"><span class="level-start"><span class="level-item">四月 2018</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/03/"><span class="level-start"><span class="level-item">三月 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/02/"><span class="level-start"><span class="level-item">二月 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/01/"><span class="level-start"><span class="level-item">一月 2018</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/12/"><span class="level-start"><span class="level-item">十二月 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/10/"><span class="level-start"><span class="level-item">十月 2017</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/09/"><span class="level-start"><span class="level-item">九月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/03/"><span class="level-start"><span class="level-item">三月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/01/"><span class="level-start"><span class="level-item">一月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/12/"><span class="level-start"><span class="level-item">十二月 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/249b2dc63505.html"><img src="/images/pics/5300c911560a8d2e0d745dcaf025d22f.jpg" alt="M系列MacBook连接l2tp时失败的问题修复"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/249b2dc63505.html">M系列MacBook连接l2tp时失败的问题修复</a></p><p class="categories"><a href="/categories/macOS/">macOS</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/e9036e8500f6.html"><img src="/images/thumbnails/rust-lang.png" alt="Rust学习笔记"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/e9036e8500f6.html">Rust学习笔记</a></p><p class="categories"><a href="/categories/Rust/">Rust</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/b0874d97f2ec.html"><img src="/images/pics/8a16be7bbc191e48a6e5b08755f591ec.png" alt="01.AI概览"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/b0874d97f2ec.html">01.AI概览</a></p><p class="categories"><a href="/categories/AI/">AI</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/4948e86c1262.html"><img src="/images/pics/DrRvr9.jpg" alt="Calico证书学习笔记"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/4948e86c1262.html">Calico证书学习笔记</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/09/6dae87e31dc3.html"><img src="/images/pics/e9f22d889a230bfda8e24c0a981740a8.png" alt="如何在YAML文件中进行优雅地换行"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-08T16:00:00.000Z">2024-12-09</time></p><p class="title"><a href="/2024/12/09/6dae87e31dc3.html">如何在YAML文件中进行优雅地换行</a></p><p class="categories"><a href="/categories/Golang/">Golang</a></p></div></article></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://crisfang.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Cris</span></span><span class="level-right"><span class="level-item tag">crisfang.com</span></span></a></li><li><a class="level is-mobile" href="https://sanyuesha.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">三月沙</span></span><span class="level-right"><span class="level-item tag">sanyuesha.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/pics/d261cdb6203e0da42ae1324dd3aae11f.png" alt="遇寻笔记" height="28"></a><p class="is-size-7"><span>&copy; 2024 遇寻</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="To Find Me" href="https://github.com/eucham"><i class="fab fa-github"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/eucham"><i class="fab fa-linkedin"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>